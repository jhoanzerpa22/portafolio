import{$ as Ji,A as _t,B as Vc,C as Lc,E as Ne,Ea as eu,F as ur,G as Mc,I as Fc,K as Uc,N as qc,O as Bc,P as en,Q as yt,R as $c,T as It,U as We,V as lr,X as zc,Z as hr,_ as dr,a as sr,aa as Xi,b as or,ca as fr,d as $,da as jc,e as d,ea as Gc,f as Zt,g as Pc,h as Cc,i as Dc,j as kc,l as Wi,m as Ki,ma as Wc,n as Hi,na as Kc,oa as Hc,p as Qi,pa as Qc,qa as Yc,r as Yi,s as Nc,t as Oc,ta as Jc,ua as Xc,v as ar,w as mt,x as gt,xa as Zc,y as cr,z as xc}from"./chunk-TIWNVO6E.js";var yy="*";function ru(t,e){return{type:7,name:t,definitions:e,options:{}}}function Zi(t,e=null){return{type:4,styles:e,timings:t}}function Iy(t,e=null){return{type:2,steps:t,options:e}}function pr(t){return{type:6,styles:t,offset:null}}function iu(t,e,n){return{type:0,name:t,styles:e,options:n}}function es(t,e,n=null){return{type:1,expr:t,animation:e,options:n}}var tu=class{constructor(e=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){let n=e=="start"?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}},nu=class{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let n=0,r=0,i=0,s=this.players.length;s==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++n==s&&this._onFinish()}),o.onDestroy(()=>{++r==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){let n=e*this.totalTime;this.players.forEach(r=>{let i=r.totalTime?Math.min(1,n/r.totalTime):1;r.setPosition(i)})}getPosition(){let e=this.players.reduce((n,r)=>n===null||r.totalTime>n.totalTime?r:n,null);return e!=null?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){let n=e=="start"?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}},vy="!";var Od=["overlay"];function xd(t,e){t&1&&Xi(0,"div")}function Vd(t,e){if(t&1&&(dr(0,"div"),hr(1,xd,1,0,"div",6),Ji()),t&2){let n=fr(2);zc(n.spinner.class),lr("color",n.spinner.color),en(1),We("ngForOf",n.spinner.divArray)}}function Ld(t,e){if(t&1&&(Xi(0,"div",7),Wc(1,"safeHtml")),t&2){let n=fr(2);We("innerHTML",Kc(1,1,n.template),Fc)}}function Md(t,e){if(t&1&&(dr(0,"div",1,2),hr(2,Vd,2,5,"div",3)(3,Ld,2,3,"div",4),dr(4,"div",5),Gc(5),Ji()()),t&2){let n=fr();lr("background-color",n.spinner.bdColor)("z-index",n.spinner.zIndex)("position",n.spinner.fullScreen?"fixed":"absolute"),We("@.disabled",n.disableAnimation)("@fadeIn","in"),en(2),We("ngIf",!n.template),en(1),We("ngIf",n.template),en(1),lr("z-index",n.spinner.zIndex)}}var Fd=["*"],Ud={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":4,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1},ts={BD_COLOR:"rgba(51,51,51,0.8)",SPINNER_COLOR:"#fff",Z_INDEX:99999},ns="primary",Ke=class t{constructor(e){Object.assign(this,e)}static create(e){return!e?.template&&!e?.type&&console.warn(`[ngx-spinner]: Property "type" is missed. Please, provide animation type to <ngx-spinner> component
        and ensure css is added to angular.json file`),new t(e)}},qd=(()=>{let e=class e{constructor(){this.spinnerObservable=new Cc(null)}getSpinner(r){return this.spinnerObservable.asObservable().pipe(Yi(i=>i&&i.name===r))}show(r=ns,i){return new Promise((s,o)=>{setTimeout(()=>{i&&Object.keys(i).length?(i.name=r,this.spinnerObservable.next(new Ke(or(sr({},i),{show:!0}))),s(!0)):(this.spinnerObservable.next(new Ke({name:r,show:!0})),s(!0))},10)})}hide(r=ns,i=10){return new Promise((s,o)=>{setTimeout(()=>{this.spinnerObservable.next(new Ke({name:r,show:!1})),s(!0)},i)})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ar({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),su=new gt("NGX_SPINNER_CONFIG"),Bd=(()=>{let e=class e{constructor(r){this._sanitizer=r}transform(r){if(r)return this._sanitizer.bypassSecurityTrustHtml(r)}};e.\u0275fac=function(i){return new(i||e)(yt(eu,16))},e.\u0275pipe=Vc({name:"safeHtml",type:e,pure:!0});let t=e;return t})(),Fy=(()=>{let e=class e{constructor(r,i,s,o){this.spinnerService=r,this.changeDetector=i,this.elementRef=s,this.globalConfig=o,this.disableAnimation=!1,this.spinner=new Ke,this.ngUnsubscribe=new Pc,this.setDefaultOptions=()=>{let{type:a}=this.globalConfig??{};this.spinner=Ke.create({name:this.name,bdColor:this.bdColor,size:this.size,color:this.color,type:this.type??a,fullScreen:this.fullScreen,divArray:this.divArray,divCount:this.divCount,show:this.show,zIndex:this.zIndex,template:this.template,showSpinner:this.showSpinner})},this.bdColor=ts.BD_COLOR,this.zIndex=ts.Z_INDEX,this.color=ts.SPINNER_COLOR,this.size="large",this.fullScreen=!0,this.name=ns,this.template=null,this.showSpinner=!1,this.divArray=[],this.divCount=0,this.show=!1}initObservable(){this.spinnerService.getSpinner(this.name).pipe(Nc(this.ngUnsubscribe)).subscribe(r=>{this.setDefaultOptions(),Object.assign(this.spinner,r),r.show&&this.onInputChange(),this.changeDetector.detectChanges()})}ngOnInit(){this.setDefaultOptions(),this.initObservable()}isSpinnerZone(r){return r===this.elementRef.nativeElement.parentElement?!0:r.parentNode&&this.isSpinnerZone(r.parentNode)}ngOnChanges(r){for(let i in r)if(i){let s=r[i];if(s.isFirstChange())return;typeof s.currentValue<"u"&&s.currentValue!==s.previousValue&&s.currentValue!==""&&(this.spinner[i]=s.currentValue,i==="showSpinner"&&(s.currentValue?this.spinnerService.show(this.spinner.name,this.spinner):this.spinnerService.hide(this.spinner.name)),i==="name"&&this.initObservable())}}getClass(r,i){this.spinner.divCount=Ud[r],this.spinner.divArray=Array(this.spinner.divCount).fill(0).map((o,a)=>a);let s="";switch(i.toLowerCase()){case"small":s="la-sm";break;case"medium":s="la-2x";break;case"large":s="la-3x";break;default:break}return"la-"+r+" "+s}onInputChange(){this.spinner.class=this.getClass(this.spinner.type,this.spinner.size)}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}};e.\u0275fac=function(i){return new(i||e)(yt(qd),yt($c),yt(Uc),yt(su,8))},e.\u0275cmp=xc({type:e,selectors:[["ngx-spinner"]],viewQuery:function(i,s){if(i&1&&Qc(Od,5),i&2){let o;Hc(o=Yc())&&(s.spinnerDOM=o.first)}},inputs:{bdColor:"bdColor",size:"size",color:"color",type:"type",fullScreen:"fullScreen",name:"name",zIndex:"zIndex",template:"template",showSpinner:"showSpinner",disableAnimation:"disableAnimation"},features:[Lc],ngContentSelectors:Fd,decls:1,vars:1,consts:[["class","ngx-spinner-overlay",3,"background-color","z-index","position",4,"ngIf"],[1,"ngx-spinner-overlay"],["overlay",""],[3,"class","color",4,"ngIf"],[3,"innerHTML",4,"ngIf"],[1,"loading-text"],[4,"ngFor","ngForOf"],[3,"innerHTML"]],template:function(i,s){i&1&&(jc(),hr(0,Md,6,12,"div",0)),i&2&&We("ngIf",s.spinner.show)},dependencies:[Jc,Xc,Bd],styles:[".ngx-spinner-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%}.ngx-spinner-overlay[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.loading-text){top:50%;left:50%;margin:0;position:absolute;transform:translate(-50%,-50%)}.loading-text[_ngcontent-%COMP%]{position:absolute;top:60%;left:50%;transform:translate(-50%,-60%)}"],data:{animation:[ru("fadeIn",[iu("in",pr({opacity:1})),es(":enter",[pr({opacity:0}),Zi(300)]),es(":leave",Zi(200,pr({opacity:0})))])]},changeDetection:0});let t=e;return t})(),Uy=(()=>{let e=class e{static forRoot(r){return{ngModule:e,providers:[{provide:su,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=_t({type:e}),e.\u0275inj=mt({imports:[Zc]});let t=e;return t})();var au=function(t){let e=[],n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},$d=function(t){let e=[],n=0,r=0;for(;n<t.length;){let i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=t[n++],o=t[n++],a=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},cu={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){let s=t[i],o=i+1<t.length,a=o?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,l=s>>2,h=(s&3)<<4|a>>4,f=(a&15)<<2|u>>6,m=u&63;c||(m=64,o||(f=64)),r.push(n[l],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(au(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):$d(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){let s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;let u=i<t.length?n[t.charAt(i)]:64;++i;let h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||h==null)throw new ss;let f=s<<2|a>>4;if(r.push(f),u!==64){let m=a<<4&240|u>>2;if(r.push(m),h!==64){let b=u<<6&192|h;r.push(b)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},ss=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},zd=function(t){let e=au(t);return cu.encodeByteArray(e,!0)},tn=function(t){return zd(t).replace(/\./g,"")},as=function(t){try{return cu.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function jd(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var Gd=()=>jd().__FIREBASE_DEFAULTS__,Wd=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Kd=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&as(t[1]);return e&&JSON.parse(e)},cs=()=>{try{return Gd()||Wd()||Kd()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},uu=t=>{var e,n;return(n=(e=cs())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},lu=t=>{let e=uu(t);if(!e)return;let n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},us=()=>{var t;return(t=cs())===null||t===void 0?void 0:t.config},hu=t=>{var e;return(e=cs())===null||e===void 0?void 0:e[`_${t}`]};var mr=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};function du(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[tn(JSON.stringify(n)),tn(JSON.stringify(o)),a].join(".")}function ue(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fu(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ue())}function pu(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function mu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ls(){try{return typeof indexedDB=="object"}catch{return!1}}function gu(){return new Promise((t,e)=>{try{let n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}var Hd="FirebaseError",ce=class t extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Hd,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Re.prototype.create)}},Re=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){let r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?Qd(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ce(i,a,r)}};function Qd(t,e){return t.replace(Yd,(n,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Yd=/\{\$([^}]+)}/g;function vt(t,e){if(t===e)return!0;let n=Object.keys(t),r=Object.keys(e);for(let i of n){if(!r.includes(i))return!1;let s=t[i],o=e[i];if(ou(s)&&ou(o)){if(!vt(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!n.includes(i))return!1;return!0}function ou(t){return t!==null&&typeof t=="object"}function hs(t){let e=[];for(let[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function _u(t,e){let n=new os(t,e);return n.subscribe.bind(n)}var os=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Jd(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=is),i.error===void 0&&(i.error=is),i.complete===void 0&&(i.complete=is);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Jd(t,e){if(typeof t!="object"||t===null)return!1;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function is(){}var $y=4*60*60*1e3;function Oe(t){return t&&t._delegate?t._delegate:t}var le=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var He="[DEFAULT]";var ds=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let r=new mr;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Zd(e))try{this.getOrInitializeService({instanceIdentifier:He})}catch{}for(let[n,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(n);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=He){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return d(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=He){return this.instances.has(e)}getOptions(e=He){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;let i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){let r=this.onInitCallbacks.get(n);if(r)for(let i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Xd(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=He){return this.component?this.component.multipleInstances?e:He:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Xd(t){return t===He?void 0:t}function Zd(t){return t.instantiationMode==="EAGER"}var gr=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new ds(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};var ef=[],S=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(S||{}),tf={debug:S.DEBUG,verbose:S.VERBOSE,info:S.INFO,warn:S.WARN,error:S.ERROR,silent:S.SILENT},nf=S.INFO,rf={[S.DEBUG]:"log",[S.VERBOSE]:"log",[S.INFO]:"info",[S.WARN]:"warn",[S.ERROR]:"error"},sf=(t,e,...n)=>{if(e<t.logLevel)return;let r=new Date().toISOString(),i=rf[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},xe=class{constructor(e){this.name=e,this._logLevel=nf,this._logHandler=sf,this._userLogHandler=null,ef.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in S))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?tf[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,S.DEBUG,...e),this._logHandler(this,S.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,S.VERBOSE,...e),this._logHandler(this,S.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,S.INFO,...e),this._logHandler(this,S.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,S.WARN,...e),this._logHandler(this,S.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,S.ERROR,...e),this._logHandler(this,S.ERROR,...e)}};var of=(t,e)=>e.some(n=>t instanceof n),yu,Iu;function af(){return yu||(yu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cf(){return Iu||(Iu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var vu=new WeakMap,ps=new WeakMap,Eu=new WeakMap,fs=new WeakMap,gs=new WeakMap;function uf(t){let e=new Promise((n,r)=>{let i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(ye(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&vu.set(n,t)}).catch(()=>{}),gs.set(e,t),e}function lf(t){if(ps.has(t))return;let e=new Promise((n,r)=>{let i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});ps.set(t,e)}var ms={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ps.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Eu.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ye(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function wu(t){ms=t(ms)}function hf(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let r=t.call(_r(this),e,...n);return Eu.set(r,e.sort?e.sort():[e]),ye(r)}:cf().includes(t)?function(...e){return t.apply(_r(this),e),ye(vu.get(this))}:function(...e){return ye(t.apply(_r(this),e))}}function df(t){return typeof t=="function"?hf(t):(t instanceof IDBTransaction&&lf(t),of(t,af())?new Proxy(t,ms):t)}function ye(t){if(t instanceof IDBRequest)return uf(t);if(fs.has(t))return fs.get(t);let e=df(t);return e!==t&&(fs.set(t,e),gs.set(e,t)),e}var _r=t=>gs.get(t);function Au(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(t,e),a=ye(o);return r&&o.addEventListener("upgradeneeded",c=>{r(ye(o.result),c.oldVersion,c.newVersion,ye(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}var ff=["get","getKey","getAll","getAllKeys","count"],pf=["put","add","delete","clear"],_s=new Map;function Tu(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(_s.get(e))return _s.get(e);let n=e.replace(/FromIndex$/,""),r=e!==n,i=pf.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||ff.includes(n)))return;let s=function(o,...a){return d(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),u=c.store;return r&&(u=u.index(a.shift())),(yield Promise.all([u[n](...a),i&&c.done]))[0]})};return _s.set(e,s),s}wu(t=>or(sr({},t),{get:(e,n,r)=>Tu(e,n)||t.get(e,n,r),has:(e,n)=>!!Tu(e,n)||t.has(e,n)}));var Is=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(mf(n)){let r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}};function mf(t){let e=t.getComponent();return e?.type==="VERSION"}var vs="@firebase/app",Su="0.9.23";var Qe=new xe("@firebase/app"),gf="@firebase/app-compat",_f="@firebase/analytics-compat",yf="@firebase/analytics",If="@firebase/app-check-compat",vf="@firebase/app-check",Ef="@firebase/auth",wf="@firebase/auth-compat",Tf="@firebase/database",Af="@firebase/database-compat",Sf="@firebase/functions",bf="@firebase/functions-compat",Rf="@firebase/installations",Pf="@firebase/installations-compat",Cf="@firebase/messaging",Df="@firebase/messaging-compat",kf="@firebase/performance",Nf="@firebase/performance-compat",Of="@firebase/remote-config",xf="@firebase/remote-config-compat",Vf="@firebase/storage",Lf="@firebase/storage-compat",Mf="@firebase/firestore",Ff="@firebase/firestore-compat",Uf="firebase",qf="10.6.0";var Es="[DEFAULT]",Bf={[vs]:"fire-core",[gf]:"fire-core-compat",[yf]:"fire-analytics",[_f]:"fire-analytics-compat",[vf]:"fire-app-check",[If]:"fire-app-check-compat",[Ef]:"fire-auth",[wf]:"fire-auth-compat",[Tf]:"fire-rtdb",[Af]:"fire-rtdb-compat",[Sf]:"fire-fn",[bf]:"fire-fn-compat",[Rf]:"fire-iid",[Pf]:"fire-iid-compat",[Cf]:"fire-fcm",[Df]:"fire-fcm-compat",[kf]:"fire-perf",[Nf]:"fire-perf-compat",[Of]:"fire-rc",[xf]:"fire-rc-compat",[Vf]:"fire-gcs",[Lf]:"fire-gcs-compat",[Mf]:"fire-fst",[Ff]:"fire-fst-compat","fire-js":"fire-js",[Uf]:"fire-js-all"};var nn=new Map,ws=new Map;function $f(t,e){try{t.container.addComponent(e)}catch(n){Qe.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Le(t){let e=t.name;if(ws.has(e))return Qe.debug(`There were multiple attempts to register component ${e}.`),!1;ws.set(e,t);for(let n of nn.values())$f(n,t);return!0}function bs(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}var zf={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Ve=new Re("app","Firebase",zf);var Ts=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new le("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ve.create("app-deleted",{appName:this._name})}};var Et=qf;function Rs(t,e={}){let n=t;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Es,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Ve.create("bad-app-name",{appName:String(i)});if(n||(n=us()),!n)throw Ve.create("no-options");let s=nn.get(i);if(s){if(vt(n,s.options)&&vt(r,s.config))return s;throw Ve.create("duplicate-app",{appName:i})}let o=new gr(i);for(let c of ws.values())o.addComponent(c);let a=new Ts(n,r,o);return nn.set(i,a),a}function sn(t=Es){let e=nn.get(t);if(!e&&t===Es&&us())return Rs();if(!e)throw Ve.create("no-app",{appName:t});return e}function yr(){return Array.from(nn.values())}function G(t,e,n){var r;let i=(r=Bf[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qe.warn(a.join(" "));return}Le(new le(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var jf="firebase-heartbeat-database",Gf=1,rn="firebase-heartbeat-store",ys=null;function Cu(){return ys||(ys=Au(jf,Gf,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(rn)}}}).catch(t=>{throw Ve.create("idb-open",{originalErrorMessage:t.message})})),ys}function Wf(t){return d(this,null,function*(){try{return yield(yield Cu()).transaction(rn).objectStore(rn).get(Du(t))}catch(e){if(e instanceof ce)Qe.warn(e.message);else{let n=Ve.create("idb-get",{originalErrorMessage:e?.message});Qe.warn(n.message)}}})}function bu(t,e){return d(this,null,function*(){try{let r=(yield Cu()).transaction(rn,"readwrite");yield r.objectStore(rn).put(e,Du(t)),yield r.done}catch(n){if(n instanceof ce)Qe.warn(n.message);else{let r=Ve.create("idb-set",{originalErrorMessage:n?.message});Qe.warn(r.message)}}})}function Du(t){return`${t.name}!${t.options.appId}`}var Kf=1024,Hf=30*24*60*60*1e3,As=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new Ss(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return d(this,null,function*(){var e;let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Ru();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(s=>s.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{let o=new Date(s.date).valueOf();return Date.now()-o<=Hf}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return d(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let n=Ru(),{heartbeatsToSend:r,unsentEntries:i}=Qf(this._heartbeatsCache.heartbeats),s=tn(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function Ru(){return new Date().toISOString().substring(0,10)}function Qf(t,e=Kf){let n=[],r=t.slice();for(let i of t){let s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Pu(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Pu(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}var Ss=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return d(this,null,function*(){return ls()?gu().then(()=>!0).catch(()=>!1):!1})}read(){return d(this,null,function*(){return(yield this._canUseIndexedDBPromise)?(yield Wf(this.app))||{heartbeats:[]}:{heartbeats:[]}})}overwrite(e){return d(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return bu(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return d(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return bu(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Pu(t){return tn(JSON.stringify({version:2,heartbeats:t})).length}function Yf(t){Le(new le("platform-logger",e=>new Is(e),"PRIVATE")),Le(new le("heartbeat",e=>new As(e),"PRIVATE")),G(vs,Su,t),G(vs,Su,"esm2017"),G("fire-js","")}Yf("");var Jf="firebase",Xf="10.6.0";G(Jf,Xf,"app");var Tt=new qc("ANGULARFIRE2_VERSION");function Cs(t,e,n){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===n);if(s.length===1)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}var an=(t,e)=>{let n=e?[e]:yr(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},on=class{constructor(){return an(Zf)}},Zf="app-check";function wt(){}var Ir=class{constructor(e,n=kc){$(this,"zone");$(this,"delegate");this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Ps=class{constructor(e){$(this,"zone");$(this,"task",null);this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",wt,{},wt,wt)),n.pipe(Oc({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},cn=(()=>{let e=class e{constructor(r){$(this,"ngZone");$(this,"outsideAngular");$(this,"insideAngular");this.ngZone=r,this.outsideAngular=r.runOutsideAngular(()=>new Ir(Zone.current)),this.insideAngular=r.run(()=>new Ir(Zone.current,Dc)),globalThis.\u0275AngularFireScheduler||=this}};$(e,"\u0275fac",function(i){return new(i||e)(cr(It))}),$(e,"\u0275prov",ar({token:e,factory:e.\u0275fac,providedIn:"root"}));let t=e;return t})();function vr(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function ep(t){return vr().ngZone.runOutsideAngular(()=>t())}function Ye(t){return vr().ngZone.run(()=>t())}function tp(t){return np(vr())(t)}function np(t){return function(n){return n=n.lift(new Ps(t.ngZone)),n.pipe(Hi(t.outsideAngular),Ki(t.insideAngular))}}var rp=(t,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Ye(()=>t.apply(void 0,r))},Je=(t,e)=>function(){let n,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(n||=Ye(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",wt,{},wt,wt))),r[s]=rp(r[s],n));let i=ep(()=>t.apply(this,r));if(!e)if(i instanceof Zt){let s=vr();return i.pipe(Hi(s.outsideAngular),Ki(s.insideAngular))}else return Ye(()=>i);return i instanceof Zt?i.pipe(tp):i instanceof Promise?Ye(()=>new Promise((s,o)=>i.then(a=>Ye(()=>s(a)),a=>Ye(()=>o(a))))):typeof i=="function"&&n?function(){return setTimeout(()=>{n&&n.state==="scheduled"&&n.invoke()},10),i.apply(this,arguments)}:Ye(()=>i)};var Xe=class{constructor(e){return e}},un=class{constructor(){return yr()}};function ip(t){return t&&t.length===1?t[0]:new Xe(sn())}var Ds=new gt("angularfire2._apps"),sp={provide:Xe,useFactory:ip,deps:[[new Ne,Ds]]},op={provide:un,deps:[[new Ne,Ds]]};function ap(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Xe(r)}}var cp=(()=>{let e=class e{constructor(r){G("angularfire",Tt.full,"core"),G("angularfire",Tt.full,"app"),G("angular",Bc.full,r.toString())}};$(e,"\u0275fac",function(i){return new(i||e)(cr(Mc))}),$(e,"\u0275mod",_t({type:e})),$(e,"\u0275inj",mt({providers:[sp,op]}));let t=e;return t})();function bI(t,...e){return{ngModule:cp,providers:[{provide:Ds,useFactory:ap(t),multi:!0,deps:[It,ur,cn,...e]}]}}var RI=Je(Rs,!0);function Mu(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Fu=Mu,Uu=new Re("auth","Firebase",Mu());var Tr=new xe("@firebase/auth");function lp(t,...e){Tr.logLevel<=S.WARN&&Tr.warn(`Auth (${Et}): ${t}`,...e)}function wr(t,...e){Tr.logLevel<=S.ERROR&&Tr.error(`Auth (${Et}): ${t}`,...e)}function ku(t,...e){throw Bs(t,...e)}function qu(t,...e){return Bs(t,...e)}function hp(t,e,n){let r=Object.assign(Object.assign({},Fu()),{[e]:n});return new Re("auth","Firebase",r).create(e,{appName:t.name})}function Bs(t,...e){if(typeof t!="string"){let n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Uu.create(t,...e)}function N(t,e,...n){if(!t)throw Bs(e,...n)}function ln(t){let e="INTERNAL ASSERTION FAILED: "+t;throw wr(e),new Error(e)}function Ar(t,e){t||ln(e)}function dp(){return Nu()==="http:"||Nu()==="https:"}function Nu(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function fp(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(dp()||pu()||"connection"in navigator)?navigator.onLine:!0}function pp(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var et=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ar(n>e,"Short delay should be less than long delay!"),this.isMobile=fu()||mu()}get(){return fp()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function mp(t,e){Ar(t.emulator,"Emulator should always be set here");let{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}var Sr=class{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ln("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ln("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ln("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var gp={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var _p=new et(3e4,6e4);function Bu(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function Nr(s,o,a,c){return d(this,arguments,function*(t,e,n,r,i={}){return $u(t,i,()=>d(this,null,function*(){let u={},l={};r&&(e==="GET"?l=r:u={body:JSON.stringify(r)});let h=hs(Object.assign({key:t.config.apiKey},l)).slice(1),f=yield t._getAdditionalHeaders();return f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode),Sr.fetch()(zu(t,t.config.apiHost,n,h),Object.assign({method:e,headers:f,referrerPolicy:"no-referrer"},u))}))})}function $u(t,e,n){return d(this,null,function*(){t._canInitEmulator=!1;let r=Object.assign(Object.assign({},gp),e);try{let i=new Os(t),s=yield Promise.race([n(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Er(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Er(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Er(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Er(t,"user-disabled",o);let l=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw hp(t,l,u);ku(t,l)}}catch(i){if(i instanceof ce)throw i;ku(t,"network-request-failed",{message:String(i)})}})}function zu(t,e,n,r){let i=`${e}${n}?${r}`;return t.config.emulator?mp(t.config,i):`${t.config.apiScheme}://${i}`}var Os=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(qu(this.auth,"network-request-failed")),_p.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Er(t,e,n){let r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);let i=qu(t,e,r);return i.customData._tokenResponse=n,i}function yp(t,e){return d(this,null,function*(){return Nr(t,"POST","/v1/accounts:delete",e)})}function Ip(t,e){return d(this,null,function*(){return Nr(t,"POST","/v1/accounts:lookup",e)})}function hn(t){if(t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function $s(t,e=!1){return d(this,null,function*(){let n=Oe(t),r=yield n.getIdToken(e),i=ju(r);N(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:hn(ks(i.auth_time)),issuedAtTime:hn(ks(i.iat)),expirationTime:hn(ks(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function ks(t){return Number(t)*1e3}function ju(t){let[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return wr("JWT malformed, contained fewer than 3 sections"),null;try{let i=as(n);return i?JSON.parse(i):(wr("Failed to decode base64 JWT payload"),null)}catch(i){return wr("Caught error parsing JWT payload as JSON",i?.toString()),null}}function vp(t){let e=ju(t);return N(e,"internal-error"),N(typeof e.exp<"u","internal-error"),N(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function xs(t,e,n=!1){return d(this,null,function*(){if(n)return e;try{return yield e}catch(r){throw r instanceof ce&&Ep(r)&&t.auth.currentUser===t&&(yield t.auth.signOut()),r}})}function Ep({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var Vs=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let n=this.getInterval(e);this.timerId=setTimeout(()=>d(this,null,function*(){yield this.iteration()}),n)}iteration(){return d(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var br=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=hn(this.lastLoginAt),this.creationTime=hn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Rr(t){return d(this,null,function*(){var e;let n=t.auth,r=yield t.getIdToken(),i=yield xs(t,Ip(n,{idToken:r}));N(i?.users.length,n,"internal-error");let s=i.users[0];t._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Tp(s.providerUserInfo):[],a=wp(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!a?.length,l=c?u:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new br(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(t,h)})}function zs(t){return d(this,null,function*(){let e=Oe(t);yield Rr(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function wp(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Tp(t){return t.map(e=>{var{providerId:n}=e,r=Wi(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function Ap(t,e){return d(this,null,function*(){let n=yield $u(t,{},()=>d(this,null,function*(){let r=hs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=zu(t,i,"/v1/token",`key=${s}`),a=yield t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Sr.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})}function Sp(t,e){return d(this,null,function*(){return Nr(t,"POST","/v2/accounts:revokeToken",Bu(t,e))})}var Pr=class t{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){N(e.idToken,"internal-error"),N(typeof e.idToken<"u","internal-error"),N(typeof e.refreshToken<"u","internal-error");let n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):vp(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}getToken(e,n=!1){return d(this,null,function*(){return N(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null})}clearRefreshToken(){this.refreshToken=null}refresh(e,n){return d(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield Ap(e,n);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){let{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new t;return r&&(N(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(N(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(N(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new t,this.toJSON())}_performRefresh(){return ln("not implemented")}};function Me(t,e){N(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var Cr=class t{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Wi(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Vs(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new br(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return d(this,null,function*(){let n=yield xs(this,this.stsTokenManager.getToken(this.auth,e));return N(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n})}getIdTokenResult(e){return $s(this,e)}reload(){return zs(this)}_assign(e){this!==e&&(N(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let n=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){N(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,n=!1){return d(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&(yield Rr(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return d(this,null,function*(){let e=yield this.getIdToken();return yield xs(this,yp(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,c,u,l;let h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(i=n.email)!==null&&i!==void 0?i:void 0,m=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,b=(o=n.photoURL)!==null&&o!==void 0?o:void 0,R=(a=n.tenantId)!==null&&a!==void 0?a:void 0,w=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,V=(u=n.createdAt)!==null&&u!==void 0?u:void 0,Z=(l=n.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:Q,emailVerified:ee,isAnonymous:fe,providerData:Y,stsTokenManager:Ge}=n;N(Q&&Ge,e,"internal-error");let pt=Pr.fromJSON(this.name,Ge);N(typeof Q=="string",e,"internal-error"),Me(h,e.name),Me(f,e.name),N(typeof ee=="boolean",e,"internal-error"),N(typeof fe=="boolean",e,"internal-error"),Me(m,e.name),Me(b,e.name),Me(R,e.name),Me(w,e.name),Me(V,e.name),Me(Z,e.name);let Xt=new t({uid:Q,auth:e,email:f,emailVerified:ee,displayName:h,isAnonymous:fe,photoURL:b,phoneNumber:m,tenantId:R,stsTokenManager:pt,createdAt:V,lastLoginAt:Z});return Y&&Array.isArray(Y)&&(Xt.providerData=Y.map(ir=>Object.assign({},ir))),w&&(Xt._redirectEventId=w),Xt}static _fromIdTokenResponse(e,n,r=!1){return d(this,null,function*(){let i=new Pr;i.updateFromServerResponse(n);let s=new t({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Rr(s),s})}};var Ou=new Map;function Ze(t){Ar(t instanceof Function,"Expected a class definition");let e=Ou.get(t);return e?(Ar(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Ou.set(t,e),e)}var bp=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return d(this,null,function*(){return!0})}_set(n,r){return d(this,null,function*(){this.storage[n]=r})}_get(n){return d(this,null,function*(){let r=this.storage[n];return r===void 0?null:r})}_remove(n){return d(this,null,function*(){delete this.storage[n]})}_addListener(n,r){}_removeListener(n,r){}}return t.type="NONE",t})(),Ls=bp;function Ns(t,e,n){return`firebase:${t}:${e}:${n}`}var Dr=class t{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Ns(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ns("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return d(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Cr._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return d(this,null,function*(){if(this.persistence===e)return;let n=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,n,r="authUser"){return d(this,null,function*(){if(!n.length)return new t(Ze(Ls),e,r);let i=(yield Promise.all(n.map(u=>d(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),s=i[0]||Ze(Ls),o=Ns(r,e.config.apiKey,e.name),a=null;for(let u of n)try{let l=yield u._get(o);if(l){let h=Cr._fromJSON(e,l);u!==s&&(a=h),s=u;break}}catch{}let c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new t(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(n.map(u=>d(this,null,function*(){if(u!==s)try{yield u._remove(o)}catch{}}))),new t(s,e,r))})}};function xu(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Dp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Rp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Np(e))return"Blackberry";if(Op(e))return"Webos";if(Pp(e))return"Safari";if((e.includes("chrome/")||Cp(e))&&!e.includes("edge/"))return"Chrome";if(kp(e))return"Android";{let n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function Rp(t=ue()){return/firefox\//i.test(t)}function Pp(t=ue()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Cp(t=ue()){return/crios\//i.test(t)}function Dp(t=ue()){return/iemobile/i.test(t)}function kp(t=ue()){return/android/i.test(t)}function Np(t=ue()){return/blackberry/i.test(t)}function Op(t=ue()){return/webos/i.test(t)}function Gu(t,e=[]){let n;switch(t){case"Browser":n=xu(ue());break;case"Worker":n=`${xu(ue())}-${t}`;break;default:n=t}let r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Et}/${r}`}var Ms=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return d(this,null,function*(){if(this.auth.currentUser===e)return;let n=[];try{for(let r of this.queue)yield r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(let i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function xp(n){return d(this,arguments,function*(t,e={}){return Nr(t,"GET","/v2/passwordPolicy",Bu(t,e))})}var Vp=6,Fs=class{constructor(e){var n,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Vp,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,n){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Us=class{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new kr(this),this.idTokenSubscription=new kr(this),this.beforeStateQueue=new Ms(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Uu,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ze(n)),this._initializationPromise=this.queue(()=>d(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Dr.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return d(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUser(e){return d(this,null,function*(){var n;let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return N(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return d(this,null,function*(){let n=null;try{n=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return n})}reloadAndSetCurrentUserOrClear(e){return d(this,null,function*(){try{yield Rr(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=pp()}_delete(){return d(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return d(this,null,function*(){let n=e?Oe(e):null;return n&&N(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))})}_updateCurrentUser(e,n=!1){return d(this,null,function*(){if(!this._deleted)return e&&N(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>d(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return d(this,null,function*(){return yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0)})}setPersistence(e){return this.queue(()=>d(this,null,function*(){yield this.assertedPersistence.setPersistence(Ze(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return d(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return d(this,null,function*(){let e=yield xp(this),n=new Fs(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Re("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},n)}})}revokeAccessToken(e){return d(this,null,function*(){if(this.currentUser){let n=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),yield Sp(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,n){return d(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return d(this,null,function*(){if(!this.redirectPersistenceManager){let n=e&&Ze(e)||this._popupRedirectResolver;N(n,this,"argument-error"),this.redirectPersistenceManager=yield Dr.create(this,[Ze(n._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return d(this,null,function*(){var n,r;return this._isInitialized&&(yield this.queue(()=>d(this,null,function*(){}))),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return d(this,null,function*(){if(e===this.currentUser)return this.queue(()=>d(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};let s=typeof n=="function"?n:n.next.bind(n),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(N(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){let c=e.addObserver(n,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(n);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return d(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return N(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Gu(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return d(this,null,function*(){var e;let n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(n["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n})}_getAppCheckToken(){return d(this,null,function*(){var e;let n=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return n?.error&&lp(`Error while retrieving App Check token: ${n.error}`),n?.token})}};function Lp(t){return Oe(t)}var kr=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=_u(n=>this.observer=n)}get next(){return N(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};function Mp(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function Fp(t,e){let n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(Ze);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}var qI=Mp("rcb"),BI=new et(3e4,6e4);var $I=new et(2e3,1e4);var zI=10*60*1e3;var jI=new et(3e4,6e4);var GI=new et(5e3,15e3);var WI=encodeURIComponent("fac");var Vu="@firebase/auth",Lu="1.4.0";var qs=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return d(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){N(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Up(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function qp(t){Le(new le("auth",(e,{options:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;N(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Gu(t)},u=new Us(r,i,s,c);return Fp(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Le(new le("auth-internal",e=>{let n=Lp(e.getProvider("auth").getImmediate());return(r=>new qs(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),G(Vu,Lu,Up(t)),G(Vu,Lu,"esm2017")}var Bp=5*60,KI=hu("authIdTokenMaxAge")||Bp;qp("Browser");var Um="auth";var Or=class{constructor(){return an(Um)}};var qm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},me={},g,ho=ho||{},E=qm||self;function Hr(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Sn(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Bm(t){return Object.prototype.hasOwnProperty.call(t,js)&&t[js]||(t[js]=++$m)}var js="closure_uid_"+(1e9*Math.random()>>>0),$m=0;function zm(t,e,n){return t.call.apply(t.bind,arguments)}function jm(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function te(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?te=zm:te=jm,te.apply(null,arguments)}function xr(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function K(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Fe(){this.s=this.s,this.o=this.o}var Gm=0;Fe.prototype.s=!1;Fe.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),Gm!=0)&&Bm(this)};Fe.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var il=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function fo(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function Wu(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(Hr(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function ne(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}ne.prototype.h=function(){this.defaultPrevented=!0};var Wm=function(){if(!E.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{E.addEventListener("test",()=>{},e),E.removeEventListener("test",()=>{},e)}catch{}return t}();function _n(t){return/^[\s\xa0]*$/.test(t)}function Qr(){var t=E.navigator;return t&&(t=t.userAgent)?t:""}function Ie(t){return Qr().indexOf(t)!=-1}function po(t){return po[" "](t),t}po[" "]=function(){};function Km(t,e){var n=Vg;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var Hm=Ie("Opera"),Rt=Ie("Trident")||Ie("MSIE"),sl=Ie("Edge"),Qs=sl||Rt,ol=Ie("Gecko")&&!(Qr().toLowerCase().indexOf("webkit")!=-1&&!Ie("Edge"))&&!(Ie("Trident")||Ie("MSIE"))&&!Ie("Edge"),Qm=Qr().toLowerCase().indexOf("webkit")!=-1&&!Ie("Edge");function al(){var t=E.document;return t?t.documentMode:void 0}var Ys;e:{if(Vr="",Lr=function(){var t=Qr();if(ol)return/rv:([^\);]+)(\)|;)/.exec(t);if(sl)return/Edge\/([\d\.]+)/.exec(t);if(Rt)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Qm)return/WebKit\/(\S+)/.exec(t);if(Hm)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),Lr&&(Vr=Lr?Lr[1]:""),Rt&&(Mr=al(),Mr!=null&&Mr>parseFloat(Vr))){Ys=String(Mr);break e}Ys=Vr}var Vr,Lr,Mr,Js;E.document&&Rt?(Gs=al(),Js=Gs||parseInt(Ys,10)||void 0):Js=void 0;var Gs,Ym=Js;function yn(t,e){if(ne.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(ol){e:{try{po(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Jm[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&yn.$.h.call(this)}}K(yn,ne);var Jm={2:"touch",3:"pen",4:"mouse"};yn.prototype.h=function(){yn.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var bn="closure_listenable_"+(1e6*Math.random()|0),Xm=0;function Zm(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++Xm,this.fa=this.ia=!1}function Yr(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function mo(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function eg(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function cl(t){let e={};for(let n in t)e[n]=t[n];return e}var Ku="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ul(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<Ku.length;s++)n=Ku[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Jr(t){this.src=t,this.g={},this.h=0}Jr.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Zs(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new Zm(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Xs(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=il(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Yr(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Zs(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var go="closure_lm_"+(1e6*Math.random()|0),Ws={};function ll(t,e,n,r,i){if(r&&r.once)return dl(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)ll(t,e[s],n,r,i);return null}return n=Io(n),t&&t[bn]?t.O(e,n,Sn(r)?!!r.capture:!!r,i):hl(t,e,n,!1,r,i)}function hl(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Sn(i)?!!i.capture:!!i,a=yo(t);if(a||(t[go]=a=new Jr(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=tg(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Wm||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(pl(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function tg(){function t(n){return e.call(t.src,t.listener,n)}let e=ng;return t}function dl(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)dl(t,e[s],n,r,i);return null}return n=Io(n),t&&t[bn]?t.P(e,n,Sn(r)?!!r.capture:!!r,i):hl(t,e,n,!0,r,i)}function fl(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)fl(t,e[s],n,r,i);else r=Sn(r)?!!r.capture:!!r,n=Io(n),t&&t[bn]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Zs(s,n,r,i),-1<n&&(Yr(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=yo(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Zs(e,n,r,i)),(n=-1<t?e[t]:null)&&_o(n))}function _o(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[bn])Xs(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(pl(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=yo(e))?(Xs(n,t),n.h==0&&(n.src=null,e[go]=null)):Yr(t)}}}function pl(t){return t in Ws?Ws[t]:Ws[t]="on"+t}function ng(t,e){if(t.fa)t=!0;else{e=new yn(e,this);var n=t.listener,r=t.la||t.src;t.ia&&_o(t),t=n.call(r,e)}return t}function yo(t){return t=t[go],t instanceof Jr?t:null}var Ks="__closure_events_fn_"+(1e9*Math.random()>>>0);function Io(t){return typeof t=="function"?t:(t[Ks]||(t[Ks]=function(e){return t.handleEvent(e)}),t[Ks])}function W(){Fe.call(this),this.i=new Jr(this),this.S=this,this.J=null}K(W,Fe);W.prototype[bn]=!0;W.prototype.removeEventListener=function(t,e,n,r){fl(this,t,e,n,r)};function X(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new ne(e,t);else if(e instanceof ne)e.target=e.target||t;else{var i=e;e=new ne(r,t),ul(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Fr(o,r,!0,e)&&i}if(o=e.g=t,i=Fr(o,r,!0,e)&&i,i=Fr(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Fr(o,r,!1,e)&&i}W.prototype.N=function(){if(W.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Yr(n[r]);delete t.g[e],t.h--}}this.J=null};W.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};W.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Fr(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Xs(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var vo=E.JSON.stringify,eo=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function rg(){var t=Eo;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var to=class{constructor(){this.h=this.g=null}add(e,n){let r=ml.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},ml=new eo(()=>new no,t=>t.reset()),no=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function ig(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function sg(t){E.setTimeout(()=>{throw t},0)}var In,vn=!1,Eo=new to,gl=()=>{let t=E.Promise.resolve(void 0);In=()=>{t.then(og)}},og=()=>{for(var t;t=rg();){try{t.h.call(t.g)}catch(n){sg(n)}var e=ml;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}vn=!1};function Xr(t,e){W.call(this),this.h=t||1,this.g=e||E,this.j=te(this.qb,this),this.l=Date.now()}K(Xr,W);g=Xr.prototype;g.ga=!1;g.T=null;g.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),X(this,"tick"),this.ga&&(wo(this),this.start()))}};g.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function wo(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}g.N=function(){Xr.$.N.call(this),wo(this),delete this.g};function To(t,e,n){if(typeof t=="function")n&&(t=te(t,n));else if(t&&typeof t.handleEvent=="function")t=te(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:E.setTimeout(t,e||0)}function _l(t){t.g=To(()=>{t.g=null,t.i&&(t.i=!1,_l(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var ro=class extends Fe{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:_l(this)}N(){super.N(),this.g&&(E.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function En(t){Fe.call(this),this.h=t,this.g={}}K(En,Fe);var Hu=[];function yl(t,e,n,r){Array.isArray(n)||(n&&(Hu[0]=n.toString()),n=Hu);for(var i=0;i<n.length;i++){var s=ll(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Il(t){mo(t.g,function(e,n){this.g.hasOwnProperty(n)&&_o(e)},t),t.g={}}En.prototype.N=function(){En.$.N.call(this),Il(this)};En.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Zr(){this.g=!0}Zr.prototype.Ea=function(){this.g=!1};function ag(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&h[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function cg(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function St(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+lg(t,n)+(r?" "+r:"")})}function ug(t,e){t.info(function(){return"TIMEOUT: "+e})}Zr.prototype.info=function(){};function lg(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return vo(n)}catch{return e}}var it={},Qu=null;function ei(){return Qu=Qu||new W}it.Ta="serverreachability";function vl(t){ne.call(this,it.Ta,t)}K(vl,ne);function wn(t){let e=ei();X(e,new vl(e))}it.STAT_EVENT="statevent";function El(t,e){ne.call(this,it.STAT_EVENT,t),this.stat=e}K(El,ne);function se(t){let e=ei();X(e,new El(e,t))}it.Ua="timingevent";function wl(t,e){ne.call(this,it.Ua,t),this.size=e}K(wl,ne);function Rn(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return E.setTimeout(function(){t()},e)}var ti={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Tl={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Ao(){}Ao.prototype.h=null;function Yu(t){return t.h||(t.h=t.i())}function Al(){}var Pn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function So(){ne.call(this,"d")}K(So,ne);function bo(){ne.call(this,"c")}K(bo,ne);var io;function ni(){}K(ni,Ao);ni.prototype.g=function(){return new XMLHttpRequest};ni.prototype.i=function(){return{}};io=new ni;function Cn(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new En(this),this.P=hg,t=Qs?125:void 0,this.V=new Xr(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Sl}function Sl(){this.i=null,this.g="",this.h=!1}var hg=45e3,so={},Br={};g=Cn.prototype;g.setTimeout=function(t){this.P=t};function oo(t,e,n){t.L=1,t.v=ii(Ce(e)),t.s=n,t.S=!0,bl(t,null)}function bl(t,e){t.G=Date.now(),Dn(t),t.A=Ce(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),xl(n.i,"t",r),t.C=0,n=t.l.J,t.h=new Sl,t.g=th(t.l,n?e:null,!t.s),0<t.O&&(t.M=new ro(te(t.Pa,t,t.g),t.O)),yl(t.U,t.g,"readystatechange",t.nb),e=t.I?cl(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),wn(),ag(t.j,t.u,t.A,t.m,t.W,t.s)}g.nb=function(t){t=t.target;let e=this.M;e&&ve(t)==3?e.l():this.Pa(t)};g.Pa=function(t){try{if(t==this.g)e:{let l=ve(this.g);var e=this.g.Ia();let h=this.g.da();if(!(3>l)&&(l!=3||Qs||this.g&&(this.h.h||this.g.ja()||el(this.g)))){this.J||l!=4||e==7||(e==8||0>=h?wn(3):wn(2)),ri(this);var n=this.g.da();this.ca=n;t:if(Rl(this)){var r=el(this.g);t="";var i=r.length,s=ve(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){tt(this),gn(this);var o="";break t}this.h.i=new E.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,cg(this.j,this.u,this.A,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_n(a)){var u=a;break t}}u=null}if(n=u)St(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ao(this,n);else{this.i=!1,this.o=3,se(12),tt(this),gn(this);break e}}this.S?(Pl(this,l,o),Qs&&this.i&&l==3&&(yl(this.U,this.V,"tick",this.mb),this.V.start())):(St(this.j,this.m,o,null),ao(this,o)),l==4&&tt(this),this.i&&!this.J&&(l==4?Jl(this.l,this):(this.i=!1,Dn(this)))}else Ng(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.o=3,se(12)):(this.o=0,se(13)),tt(this),gn(this)}}}catch{}finally{}};function Rl(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function Pl(t,e,n){let r=!0,i;for(;!t.J&&t.C<n.length;)if(i=dg(t,n),i==Br){e==4&&(t.o=4,se(14),r=!1),St(t.j,t.m,null,"[Incomplete Response]");break}else if(i==so){t.o=4,se(15),St(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else St(t.j,t.m,i,null),ao(t,i);Rl(t)&&i!=Br&&i!=so&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,se(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),No(e),e.M=!0,se(11))):(St(t.j,t.m,n,"[Invalid Chunked Response]"),tt(t),gn(t))}g.mb=function(){if(this.g){var t=ve(this.g),e=this.g.ja();this.C<e.length&&(ri(this),Pl(this,t,e),this.i&&t!=4&&Dn(this))}};function dg(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Br:(n=Number(e.substring(n,r)),isNaN(n)?so:(r+=1,r+n>e.length?Br:(e=e.slice(r,r+n),t.C=r+n,e)))}g.cancel=function(){this.J=!0,tt(this)};function Dn(t){t.Y=Date.now()+t.P,Cl(t,t.P)}function Cl(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Rn(te(t.lb,t),e)}function ri(t){t.B&&(E.clearTimeout(t.B),t.B=null)}g.lb=function(){this.B=null;let t=Date.now();0<=t-this.Y?(ug(this.j,this.A),this.L!=2&&(wn(),se(17)),tt(this),this.o=2,gn(this)):Cl(this,this.Y-t)};function gn(t){t.l.H==0||t.J||Jl(t.l,t)}function tt(t){ri(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,wo(t.V),Il(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function ao(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||co(n.i,t))){if(!t.K&&co(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)jr(n),ai(n);else break e;ko(n),se(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Rn(te(n.ib,n),6e3));if(1>=Ml(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else nt(n,11)}else if((t.K||n.g==t)&&jr(n),!_n(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];let l=u[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let h=u[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));let f=u[5];f!=null&&typeof f=="number"&&0<f&&(r=1.5*f,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let m=t.g;if(m){let b=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(b){var s=r.i;s.g||b.indexOf("spdy")==-1&&b.indexOf("quic")==-1&&b.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Ro(s,s.h),s.h=null))}if(r.F){let R=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;R&&(r.Da=R,x(r.I,r.F,R))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=eh(r,r.J?r.pa:null,r.Y),o.K){Fl(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.B&&(ri(a),Dn(a)),r.g=o}else Ql(r);0<n.j.length&&ci(n)}else u[0]!="stop"&&u[0]!="close"||nt(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?nt(n,7):Do(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}wn(4)}catch{}}function fg(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Hr(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function pg(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Hr(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function Dl(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Hr(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=pg(t),r=fg(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var kl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function mg(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function rt(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof rt){this.h=t.h,$r(this,t.j),this.s=t.s,this.g=t.g,zr(this,t.m),this.l=t.l;var e=t.i,n=new Tn;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Ju(this,n),this.o=t.o}else t&&(e=String(t).match(kl))?(this.h=!1,$r(this,e[1]||"",!0),this.s=pn(e[2]||""),this.g=pn(e[3]||"",!0),zr(this,e[4]),this.l=pn(e[5]||"",!0),Ju(this,e[6]||"",!0),this.o=pn(e[7]||"")):(this.h=!1,this.i=new Tn(null,this.h))}rt.prototype.toString=function(){var t=[],e=this.j;e&&t.push(mn(e,Xu,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(mn(e,Xu,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(mn(n,n.charAt(0)=="/"?yg:_g,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",mn(n,vg)),t.join("")};function Ce(t){return new rt(t)}function $r(t,e,n){t.j=n?pn(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function zr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ju(t,e,n){e instanceof Tn?(t.i=e,Eg(t.i,t.h)):(n||(e=mn(e,Ig)),t.i=new Tn(e,t.h))}function x(t,e,n){t.i.set(e,n)}function ii(t){return x(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function pn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function mn(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,gg),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function gg(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Xu=/[#\/\?@]/g,_g=/[#\?:]/g,yg=/[#\?]/g,Ig=/[#\?@]/g,vg=/#/g;function Tn(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ue(t){t.g||(t.g=new Map,t.h=0,t.i&&mg(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}g=Tn.prototype;g.add=function(t,e){Ue(this),this.i=null,t=Pt(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function Nl(t,e){Ue(t),e=Pt(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Ol(t,e){return Ue(t),e=Pt(t,e),t.g.has(e)}g.forEach=function(t,e){Ue(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};g.ta=function(){Ue(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};g.Z=function(t){Ue(this);let e=[];if(typeof t=="string")Ol(this,t)&&(e=e.concat(this.g.get(Pt(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};g.set=function(t,e){return Ue(this),this.i=null,t=Pt(this,t),Ol(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};g.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function xl(t,e,n){Nl(t,e),0<n.length&&(t.i=null,t.g.set(Pt(t,e),fo(n)),t.h+=n.length)}g.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Pt(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Eg(t,e){e&&!t.j&&(Ue(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(Nl(this,r),xl(this,i,n))},t)),t.j=e}var wg=class{constructor(t,e){this.g=t,this.map=e}};function Vl(t){this.l=t||Tg,E.PerformanceNavigationTiming?(t=E.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(E.g&&E.g.Ka&&E.g.Ka()&&E.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Tg=10;function Ll(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function Ml(t){return t.h?1:t.g?t.g.size:0}function co(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Ro(t,e){t.g?t.g.add(e):t.h=e}function Fl(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}Vl.prototype.cancel=function(){if(this.i=Ul(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function Ul(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return fo(t.i)}var Ag=class{stringify(t){return E.JSON.stringify(t,void 0)}parse(t){return E.JSON.parse(t,void 0)}};function Sg(){this.g=new Ag}function bg(t,e,n){let r=n||"";try{Dl(t,function(i,s){let o=i;Sn(i)&&(o=vo(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Rg(t,e){let n=new Zr;if(E.Image){let r=new Image;r.onload=xr(Ur,n,r,"TestLoadImage: loaded",!0,e),r.onerror=xr(Ur,n,r,"TestLoadImage: error",!1,e),r.onabort=xr(Ur,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=xr(Ur,n,r,"TestLoadImage: timeout",!1,e),E.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Ur(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function kn(t){this.l=t.ec||null,this.j=t.ob||!1}K(kn,Ao);kn.prototype.g=function(){return new si(this.l,this.j)};kn.prototype.i=function(t){return function(){return t}}({});function si(t,e){W.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Po,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}K(si,W);var Po=0;g=si.prototype;g.open=function(t,e){if(this.readyState!=Po)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,An(this)};g.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||E).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};g.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Nn(this)),this.readyState=Po};g.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,An(this)),this.g&&(this.readyState=3,An(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof E.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ql(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function ql(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}g.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Nn(this):An(this),this.readyState==3&&ql(this)}};g.Za=function(t){this.g&&(this.response=this.responseText=t,Nn(this))};g.Ya=function(t){this.g&&(this.response=t,Nn(this))};g.ka=function(){this.g&&Nn(this)};function Nn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,An(t)}g.setRequestHeader=function(t,e){this.v.append(t,e)};g.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};g.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function An(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(si.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var Pg=E.JSON.parse;function L(t){W.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Bl,this.L=this.M=!1}K(L,W);var Bl="",Cg=/^https?$/i,Dg=["POST","PUT"];g=L.prototype;g.Oa=function(t){this.M=t};g.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():io.g(),this.C=this.u?Yu(this.u):Yu(io),this.g.onreadystatechange=te(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){Zu(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=E.FormData&&t instanceof E.FormData,!(0<=il(Dg,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{jl(this),0<this.B&&((this.L=kg(this.g))?(this.g.timeout=this.B,this.g.ontimeout=te(this.ua,this)):this.A=To(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){Zu(this,s)}};function kg(t){return Rt&&typeof t.timeout=="number"&&t.ontimeout!==void 0}g.ua=function(){typeof ho<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,X(this,"timeout"),this.abort(8))};function Zu(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,$l(t),oi(t)}function $l(t){t.F||(t.F=!0,X(t,"complete"),X(t,"error"))}g.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,X(this,"complete"),X(this,"abort"),oi(this))};g.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),oi(this,!0)),L.$.N.call(this)};g.La=function(){this.s||(this.G||this.v||this.l?zl(this):this.kb())};g.kb=function(){zl(this)};function zl(t){if(t.h&&typeof ho<"u"&&(!t.C[1]||ve(t)!=4||t.da()!=2)){if(t.v&&ve(t)==4)To(t.La,0,t);else if(X(t,"readystatechange"),ve(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(kl)[1]||null;!i&&E.self&&E.self.location&&(i=E.self.location.protocol.slice(0,-1)),r=!Cg.test(i?i.toLowerCase():"")}n=r}if(n)X(t,"complete"),X(t,"success");else{t.m=6;try{var s=2<ve(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",$l(t)}}finally{oi(t)}}}}function oi(t,e){if(t.g){jl(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||X(t,"ready");try{n.onreadystatechange=r}catch{}}}function jl(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(E.clearTimeout(t.A),t.A=null)}g.isActive=function(){return!!this.g};function ve(t){return t.g?t.g.readyState:0}g.da=function(){try{return 2<ve(this)?this.g.status:-1}catch{return-1}};g.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};g.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),Pg(e)}};function el(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Bl:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function Ng(t){let e={};t=(t.g&&2<=ve(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(_n(t[r]))continue;var n=ig(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}eg(e,function(r){return r.join(", ")})}g.Ia=function(){return this.m};g.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function Gl(t){let e="";return mo(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Co(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Gl(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):x(t,e,n))}function dn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wl(t){this.Ga=0,this.j=[],this.l=new Zr,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=dn("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=dn("baseRetryDelayMs",5e3,t),this.hb=dn("retryDelaySeedMs",1e4,t),this.eb=dn("forwardChannelMaxRetries",2,t),this.xa=dn("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Vl(t&&t.concurrentRequestLimit),this.Ja=new Sg,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}g=Wl.prototype;g.ra=8;g.H=1;function Do(t){if(Kl(t),t.H==3){var e=t.W++,n=Ce(t.I);if(x(n,"SID",t.K),x(n,"RID",e),x(n,"TYPE","terminate"),On(t,n),e=new Cn(t,t.l,e),e.L=2,e.v=ii(Ce(n)),n=!1,E.navigator&&E.navigator.sendBeacon)try{n=E.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&E.Image&&(new Image().src=e.v,n=!0),n||(e.g=th(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Dn(e)}Zl(t)}function ai(t){t.g&&(No(t),t.g.cancel(),t.g=null)}function Kl(t){ai(t),t.u&&(E.clearTimeout(t.u),t.u=null),jr(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&E.clearTimeout(t.m),t.m=null)}function ci(t){if(!Ll(t.i)&&!t.m){t.m=!0;var e=t.Na;In||gl(),vn||(In(),vn=!0),Eo.add(e,t),t.C=0}}function Og(t,e){return Ml(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Rn(te(t.Na,t,e),Xl(t,t.C)),t.C++,!0)}g.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Cn(this,this.l,t),s=this.s;if(this.U&&(s?(s=cl(s),ul(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=Hl(this,i,e),n=Ce(this.I),x(n,"RID",t),x(n,"CVER",22),this.F&&x(n,"X-HTTP-Session-Id",this.F),On(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Gl(s)))+"&"+e:this.o&&Co(n,this.o,s)),Ro(this.i,i),this.bb&&x(n,"TYPE","init"),this.P?(x(n,"$req",e),x(n,"SID","null"),i.aa=!0,oo(i,n,null)):oo(i,n,e),this.H=2}}else this.H==3&&(t?tl(this,t):this.j.length==0||Ll(this.i)||tl(this))};function tl(t,e){var n;e?n=e.m:n=t.W++;let r=Ce(t.I);x(r,"SID",t.K),x(r,"RID",n),x(r,"AID",t.V),On(t,r),t.o&&t.s&&Co(r,t.o,t.s),n=new Cn(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Hl(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Ro(t.i,n),oo(n,r,e)}function On(t,e){t.na&&mo(t.na,function(n,r){x(e,r,n)}),t.h&&Dl({},function(n,r){x(e,r,n)})}function Hl(t,e,n){n=Math.min(t.j.length,n);var r=t.h?te(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let u=i[c].g,l=i[c].map;if(u-=s,0>u)s=Math.max(0,i[c].g-100),a=!1;else try{bg(l,o,"req"+u+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function Ql(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;In||gl(),vn||(In(),vn=!0),Eo.add(e,t),t.A=0}}function ko(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Rn(te(t.Ma,t),Xl(t,t.A)),t.A++,!0)}g.Ma=function(){if(this.u=null,Yl(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Rn(te(this.jb,this),t)}};g.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,se(10),ai(this),Yl(this))};function No(t){t.B!=null&&(E.clearTimeout(t.B),t.B=null)}function Yl(t){t.g=new Cn(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Ce(t.wa);x(e,"RID","rpc"),x(e,"SID",t.K),x(e,"AID",t.V),x(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&x(e,"TO",t.qa),x(e,"TYPE","xmlhttp"),On(t,e),t.o&&t.s&&Co(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=ii(Ce(e)),n.s=null,n.S=!0,bl(n,t)}g.ib=function(){this.v!=null&&(this.v=null,ai(this),ko(this),se(19))};function jr(t){t.v!=null&&(E.clearTimeout(t.v),t.v=null)}function Jl(t,e){var n=null;if(t.g==e){jr(t),No(t),t.g=null;var r=2}else if(co(t.i,e))n=e.F,Fl(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var i=t.C;r=ei(),X(r,new wl(r,n)),ci(t)}else Ql(t);else if(i=e.o,i==3||i==0&&0<e.ca||!(r==1&&Og(t,e)||r==2&&ko(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:nt(t,5);break;case 4:nt(t,10);break;case 3:nt(t,6);break;default:nt(t,2)}}}function Xl(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function nt(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=te(t.pb,t);n||(n=new rt("//www.google.com/images/cleardot.gif"),E.location&&E.location.protocol=="http"||$r(n,"https"),ii(n)),Rg(n.toString(),r)}else se(2);t.H=0,t.h&&t.h.za(e),Zl(t),Kl(t)}g.pb=function(t){t?(this.l.info("Successfully pinged google.com"),se(2)):(this.l.info("Failed to ping google.com"),se(1))};function Zl(t){if(t.H=0,t.ma=[],t.h){let e=Ul(t.i);(e.length!=0||t.j.length!=0)&&(Wu(t.ma,e),Wu(t.ma,t.j),t.i.i.length=0,fo(t.j),t.j.length=0),t.h.ya()}}function eh(t,e,n){var r=n instanceof rt?Ce(n):new rt(n);if(r.g!="")e&&(r.g=e+"."+r.g),zr(r,r.m);else{var i=E.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new rt(null);r&&$r(s,r),e&&(s.g=e),i&&zr(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&x(r,n,e),x(r,"VER",t.ra),On(t,r),r}function th(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new L(new kn({ob:!0})):new L(t.va),e.Oa(t.J),e}g.isActive=function(){return!!this.h&&this.h.isActive(this)};function nh(){}g=nh.prototype;g.Ba=function(){};g.Aa=function(){};g.za=function(){};g.ya=function(){};g.isActive=function(){return!0};g.Va=function(){};function Gr(){if(Rt&&!(10<=Number(Ym)))throw Error("Environmental error: no available transport.")}Gr.prototype.g=function(t,e){return new ae(t,e)};function ae(t,e){W.call(this),this.g=new Wl(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!_n(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!_n(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Ct(this)}K(ae,W);ae.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;se(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=eh(t,null,t.Y),ci(t)};ae.prototype.close=function(){Do(this.g)};ae.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=vo(t),t=n);e.j.push(new wg(e.fb++,t)),e.H==3&&ci(e)};ae.prototype.N=function(){this.g.h=null,delete this.j,Do(this.g),delete this.g,ae.$.N.call(this)};function rh(t){So.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}K(rh,So);function ih(){bo.call(this),this.status=1}K(ih,bo);function Ct(t){this.g=t}K(Ct,nh);Ct.prototype.Ba=function(){X(this.g,"a")};Ct.prototype.Aa=function(t){X(this.g,new rh(t))};Ct.prototype.za=function(t){X(this.g,new ih)};Ct.prototype.ya=function(){X(this.g,"b")};function xg(){this.blockSize=-1}function pe(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}K(pe,xg);pe.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Hs(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}pe.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)Hs(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Hs(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Hs(this,r),i=0;break}}this.h=i,this.i+=e};pe.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function O(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var Vg={};function Oo(t){return-128<=t&&128>t?Km(t,function(e){return new O([e|0],0>e?-1:0)}):new O([t|0],0>t?-1:0)}function Ee(t){if(isNaN(t)||!isFinite(t))return bt;if(0>t)return J(Ee(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=uo;return new O(e,0)}function sh(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return J(sh(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Ee(Math.pow(e,8)),r=bt,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Ee(Math.pow(e,s)),r=r.R(s).add(Ee(o))):(r=r.R(n),r=r.add(Ee(o)))}return r}var uo=4294967296,bt=Oo(0),lo=Oo(1),nl=Oo(16777216);g=O.prototype;g.ea=function(){if(he(this))return-J(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:uo+r)*e,e*=uo}return t};g.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Pe(this))return"0";if(he(this))return"-"+J(this).toString(t);for(var e=Ee(Math.pow(t,6)),n=this,r="";;){var i=Kr(n,e).g;n=Wr(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Pe(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};g.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Pe(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function he(t){return t.h==-1}g.X=function(t){return t=Wr(this,t),he(t)?-1:Pe(t)?0:1};function J(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new O(n,~t.h).add(lo)}g.abs=function(){return he(this)?J(this):this};g.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new O(n,n[n.length-1]&-2147483648?-1:0)};function Wr(t,e){return t.add(J(e))}g.R=function(t){if(Pe(this)||Pe(t))return bt;if(he(this))return he(t)?J(this).R(J(t)):J(J(this).R(t));if(he(t))return J(this.R(J(t)));if(0>this.X(nl)&&0>t.X(nl))return Ee(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,qr(n,2*r+2*i),n[2*r+2*i+1]+=s*c,qr(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,qr(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,qr(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new O(n,0)};function qr(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function fn(t,e){this.g=t,this.h=e}function Kr(t,e){if(Pe(e))throw Error("division by zero");if(Pe(t))return new fn(bt,bt);if(he(t))return e=Kr(J(t),e),new fn(J(e.g),J(e.h));if(he(e))return e=Kr(t,J(e)),new fn(J(e.g),e.h);if(30<t.g.length){if(he(t)||he(e))throw Error("slowDivide_ only works with positive integers.");for(var n=lo,r=e;0>=r.X(t);)n=rl(n),r=rl(r);var i=At(n,1),s=At(r,1);for(r=At(r,2),n=At(n,2);!Pe(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=At(r,1),n=At(n,1)}return e=Wr(t,i.R(e)),new fn(i,e)}for(i=bt;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Ee(n),o=s.R(e);he(o)||0<o.X(t);)n-=r,s=Ee(n),o=s.R(e);Pe(s)&&(s=lo),i=i.add(s),t=Wr(t,o)}return new fn(i,t)}g.gb=function(t){return Kr(this,t).h};g.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new O(n,this.h&t.h)};g.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new O(n,this.h|t.h)};g.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new O(n,this.h^t.h)};function rl(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new O(n,t.h)}function At(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new O(i,t.h)}Gr.prototype.createWebChannel=Gr.prototype.g;ae.prototype.send=ae.prototype.u;ae.prototype.open=ae.prototype.m;ae.prototype.close=ae.prototype.close;ti.NO_ERROR=0;ti.TIMEOUT=8;ti.HTTP_ERROR=6;Tl.COMPLETE="complete";Al.EventType=Pn;Pn.OPEN="a";Pn.CLOSE="b";Pn.ERROR="c";Pn.MESSAGE="d";W.prototype.listen=W.prototype.O;L.prototype.listenOnce=L.prototype.P;L.prototype.getLastError=L.prototype.Sa;L.prototype.getLastErrorCode=L.prototype.Ia;L.prototype.getStatus=L.prototype.da;L.prototype.getResponseJson=L.prototype.Wa;L.prototype.getResponseText=L.prototype.ja;L.prototype.send=L.prototype.ha;L.prototype.setWithCredentials=L.prototype.Oa;pe.prototype.digest=pe.prototype.l;pe.prototype.reset=pe.prototype.reset;pe.prototype.update=pe.prototype.j;O.prototype.add=O.prototype.add;O.prototype.multiply=O.prototype.R;O.prototype.modulo=O.prototype.gb;O.prototype.compare=O.prototype.X;O.prototype.toNumber=O.prototype.ea;O.prototype.toString=O.prototype.toString;O.prototype.getBits=O.prototype.D;O.fromNumber=Ee;O.fromString=sh;var oh=me.createWebChannelTransport=function(){return new Gr},ah=me.getStatEventTarget=function(){return ei()},ui=me.ErrorCode=ti,ch=me.EventType=Tl,uh=me.Event=it,xo=me.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},lh=me.FetchXmlHttpFactory=kn,xn=me.WebChannel=Al,hh=me.XhrIo=L,dh=me.Md5=pe,st=me.Integer=O;var fh="@firebase/firestore";var H=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};H.UNAUTHENTICATED=new H(null),H.GOOGLE_CREDENTIALS=new H("google-credentials-uid"),H.FIRST_PARTY=new H("first-party-uid"),H.MOCK_USER=new H("mock-user");var Yt="10.5.2";var lt=new xe("@firebase/firestore");function Vn(){return lt.logLevel}function y(t,...e){if(lt.logLevel<=S.DEBUG){let n=e.map(dc);lt.debug(`Firestore (${Yt}): ${t}`,...n)}}function ke(t,...e){if(lt.logLevel<=S.ERROR){let n=e.map(dc);lt.error(`Firestore (${Yt}): ${t}`,...n)}}function Ft(t,...e){if(lt.logLevel<=S.WARN){let n=e.map(dc);lt.warn(`Firestore (${Yt}): ${t}`,...n)}}function dc(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function T(t="Unexpected state"){let e=`FIRESTORE (${Yt}) INTERNAL ASSERTION FAILED: `+t;throw ke(e),new Error(e)}function j(t,e){t||T()}function D(t,e){return t}var _={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},I=class extends ce{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var qe=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var pi=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},qo=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(H.UNAUTHENTICATED))}shutdown(){}},Bo=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},$o=class{constructor(e){this.t=e,this.currentUser=H.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new qe;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new qe,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>d(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(y("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new qe)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(j(typeof r.accessToken=="string"),new pi(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return j(e===null||typeof e=="string"),new H(e)}},zo=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=H.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},jo=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new zo(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(H.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Go=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Wo=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,y("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(j(typeof n.token=="string"),this.R=n.token,new Go(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function Lg(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Ko=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=Lg(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function k(t,e){return t<e?-1:t>e?1:0}function Ut(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}var de=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new I(_.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new I(_.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new I(_.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new I(_.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?k(this.nanoseconds,e.nanoseconds):k(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var A=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new de(0,0))}static max(){return new t(new de(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var mi=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&T(),r===void 0?r=e.length-n:r>e.length-n&&T(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},B=class t extends mi{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new I(_.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},Mg=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ge=class t extends mi{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return Mg.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new I(_.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new I(_.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new I(_.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new I(_.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var v=class t{constructor(e){this.path=e}static fromPath(e){return new t(B.fromString(e))}static fromName(e){return new t(B.fromString(e).popFirst(5))}static empty(){return new t(B.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&B.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return B.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new B(e.slice()))}};var Ho=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};Ho.UNKNOWN_ID=-1;function Fg(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=A.fromTimestamp(r===1e9?new de(n+1,0):new de(n,r));return new ht(i,v.empty(),e)}function Ug(t){return new ht(t.readTime,t.key,-1)}var ht=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(A.min(),v.empty(),-1)}static max(){return new t(A.max(),v.empty(),-1)}};function qg(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=v.comparator(t.documentKey,e.documentKey),n!==0?n:k(t.largestBatchId,e.largestBatchId))}var Bg="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Qo=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function fc(t){return d(this,null,function*(){if(t.code!==_.FAILED_PRECONDITION||t.message!==Bg)throw t;y("LocalStore","Unexpectedly lost primary lease")})}var p=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&T(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;n(e[u]).next(l=>{o[u]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};function er(t){return t.name==="IndexedDbTransactionError"}var zh=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function qi(t){return t==null}function gi(t){return t===0&&1/t==-1/0}var $g=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Qv=[...$g,"documentOverlays"],zg=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],jg=zg,Yv=[...jg,"indexConfiguration","indexState","indexEntries"];function ph(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Bi(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Gg(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var F=class t{constructor(e,n){this.comparator=e,this.root=n||Te.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Te.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Te.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ot(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ot(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ot(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ot(this.root,e,this.comparator,!0)}},Ot=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Te=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw T();let e=this.left.check();if(e!==this.right.check())throw T();return e+(this.isRed()?0:1)}};Te.EMPTY=null,Te.RED=!0,Te.BLACK=!1;Te.EMPTY=new class{constructor(){this.size=0}get key(){throw T()}get value(){throw T()}get color(){throw T()}get left(){throw T()}get right(){throw T()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Te(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ie=class t{constructor(e){this.comparator=e,this.data=new F(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new _i(this.data.getIterator())}getIteratorFrom(e){return new _i(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},_i=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var ot=class t{constructor(e){this.fields=e,e.sort(ge.comparator)}static empty(){return new t([])}unionWith(e){let n=new ie(ge.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ut(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var yi=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var oe=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new yi("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return k(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};oe.EMPTY_BYTE_STRING=new oe("");var Wg=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Be(t){if(j(!!t),typeof t=="string"){let e=0,n=Wg.exec(t);if(j(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:M(t.seconds),nanos:M(t.nanos)}}function M(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function $e(t){return typeof t=="string"?oe.fromBase64String(t):oe.fromUint8Array(t)}function pc(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function mc(t){let e=t.mapValue.fields.__previous_value__;return pc(e)?mc(e):e}function $n(t){let e=Be(t.mapValue.fields.__local_write_time__.timestampValue);return new de(e.seconds,e.nanos)}var Yo=class{constructor(e,n,r,i,s,o,a,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},Ii=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var li={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function dt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?pc(t)?4:jh(t)?9007199254740991:10:T()}function Se(t,e){if(t===e)return!0;let n=dt(t);if(n!==dt(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return $n(t).isEqual($n(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Be(i.timestampValue),a=Be(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return $e(i.bytesValue).isEqual($e(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return M(i.geoPointValue.latitude)===M(s.geoPointValue.latitude)&&M(i.geoPointValue.longitude)===M(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return M(i.integerValue)===M(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=M(i.doubleValue),a=M(s.doubleValue);return o===a?gi(o)===gi(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ut(t.arrayValue.values||[],e.arrayValue.values||[],Se);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(ph(o)!==ph(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Se(o[c],a[c])))return!1;return!0}(t,e);default:return T()}}function zn(t,e){return(t.values||[]).find(n=>Se(n,e))!==void 0}function qt(t,e){if(t===e)return 0;let n=dt(t),r=dt(e);if(n!==r)return k(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return k(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=M(s.integerValue||s.doubleValue),c=M(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return mh(t.timestampValue,e.timestampValue);case 4:return mh($n(t),$n(e));case 5:return k(t.stringValue,e.stringValue);case 6:return function(s,o){let a=$e(s),c=$e(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let l=k(a[u],c[u]);if(l!==0)return l}return k(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=k(M(s.latitude),M(o.latitude));return a!==0?a:k(M(s.longitude),M(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){let l=qt(a[u],c[u]);if(l)return l}return k(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===li.mapValue&&o===li.mapValue)return 0;if(s===li.mapValue)return 1;if(o===li.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},l=Object.keys(u);c.sort(),l.sort();for(let h=0;h<c.length&&h<l.length;++h){let f=k(c[h],l[h]);if(f!==0)return f;let m=qt(a[c[h]],u[l[h]]);if(m!==0)return m}return k(c.length,l.length)}(t.mapValue,e.mapValue);default:throw T()}}function mh(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return k(t,e);let n=Be(t),r=Be(e),i=k(n.seconds,r.seconds);return i!==0?i:k(n.nanos,r.nanos)}function Bt(t){return Jo(t)}function Jo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Be(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return $e(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return v.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=Jo(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Jo(n.fields[o])}`;return i+"}"}(t.mapValue):T()}function Xo(t){return!!t&&"integerValue"in t}function gc(t){return!!t&&"arrayValue"in t}function gh(t){return!!t&&"nullValue"in t}function _h(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vo(t){return!!t&&"mapValue"in t}function Mn(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return Bi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Mn(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Mn(t.arrayValue.values[n]);return e}return Object.assign({},t)}function jh(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var De=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Vo(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Mn(n)}setAll(e){let n=ge.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Mn(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Vo(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Se(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Vo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Bi(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(Mn(this.value))}};var _e=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,A.min(),A.min(),A.min(),De.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,A.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,A.min(),A.min(),De.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,A.min(),A.min(),De.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(A.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=De.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=De.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=A.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var $t=class{constructor(e,n){this.position=e,this.inclusive=n}};function yh(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=v.comparator(v.fromName(o.referenceValue),n.key):r=qt(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ih(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Se(t.position[n],e.position[n]))return!1;return!0}var zt=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function Kg(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var vi=class{},z=class t extends vi{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new ea(e,n,r):n==="array-contains"?new ra(e,r):n==="in"?new ia(e,r):n==="not-in"?new sa(e,r):n==="array-contains-any"?new oa(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new ta(e,r):new na(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(qt(n,this.value)):n!==null&&dt(this.value)===dt(n)&&this.matchesComparison(qt(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return T()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},be=class t extends vi{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return Gh(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function Gh(t){return t.op==="and"}function Wh(t){return Hg(t)&&Gh(t)}function Hg(t){for(let e of t.filters)if(e instanceof be)return!1;return!0}function Zo(t){if(t instanceof z)return t.field.canonicalString()+t.op.toString()+Bt(t.value);if(Wh(t))return t.filters.map(e=>Zo(e)).join(",");{let e=t.filters.map(n=>Zo(n)).join(",");return`${t.op}(${e})`}}function Kh(t,e){return t instanceof z?function(r,i){return i instanceof z&&r.op===i.op&&r.field.isEqual(i.field)&&Se(r.value,i.value)}(t,e):t instanceof be?function(r,i){return i instanceof be&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&Kh(o,i.filters[a]),!0):!1}(t,e):void T()}function Hh(t){return t instanceof z?function(n){return`${n.field.canonicalString()} ${n.op} ${Bt(n.value)}`}(t):t instanceof be?function(n){return n.op.toString()+" {"+n.getFilters().map(Hh).join(" ,")+"}"}(t):"Filter"}var ea=class extends z{constructor(e,n,r){super(e,n,r),this.key=v.fromName(r.referenceValue)}matches(e){let n=v.comparator(e.key,this.key);return this.matchesComparison(n)}},ta=class extends z{constructor(e,n){super(e,"in",n),this.keys=Qh("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},na=class extends z{constructor(e,n){super(e,"not-in",n),this.keys=Qh("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function Qh(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>v.fromName(r.referenceValue))}var ra=class extends z{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return gc(n)&&zn(n.arrayValue,this.value)}},ia=class extends z{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&zn(this.value.arrayValue,n)}},sa=class extends z{constructor(e,n){super(e,"not-in",n)}matches(e){if(zn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!zn(this.value.arrayValue,n)}},oa=class extends z{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!gc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>zn(this.value.arrayValue,r))}};var aa=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function vh(t,e=null,n=[],r=[],i=null,s=null,o=null){return new aa(t,e,n,r,i,s,o)}function _c(t){let e=D(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Zo(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),qi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Bt(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Bt(r)).join(",")),e.ce=n}return e.ce}function yc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Kg(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Kh(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ih(t.startAt,e.startAt)&&Ih(t.endAt,e.endAt)}function ca(t){return v.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}var jt=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function Qg(t,e,n,r,i,s,o,a){return new jt(t,e,n,r,i,s,o,a)}function Ic(t){return new jt(t)}function Eh(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Yg(t){return t.collectionGroup!==null}function Fn(t){let e=D(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ie(ge.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new zt(s,r))}),n.has(ge.keyField().canonicalString())||e.le.push(new zt(ge.keyField(),r))}return e.le}function Ae(t){let e=D(t);return e.he||(e.he=Jg(e,Fn(t))),e.he}function Jg(t,e){if(t.limitType==="F")return vh(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new zt(i.field,s)});let n=t.endAt?new $t(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new $t(t.startAt.position,t.startAt.inclusive):null;return vh(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function ua(t,e,n){return new jt(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function $i(t,e){return yc(Ae(t),Ae(e))&&t.limitType===e.limitType}function Yh(t){return`${_c(Ae(t))}|lt:${t.limitType}`}function Dt(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Hh(i)).join(", ")}]`),qi(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Bt(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Bt(i)).join(",")),`Target(${r})`}(Ae(t))}; limitType=${t.limitType})`}function zi(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):v.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Fn(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=yh(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,Fn(r),i)||r.endAt&&!function(o,a,c){let u=yh(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,Fn(r),i))}(t,e)}function Xg(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Jh(t){return(e,n)=>{let r=!1;for(let i of Fn(t)){let s=Zg(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Zg(t,e,n){let r=t.field.isKeyField()?v.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?qt(c,u):T()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return T()}}var ze=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Bi(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return Gg(this.inner)}size(){return this.innerSize}};var e_=new F(v.comparator);function je(){return e_}var Xh=new F(v.comparator);function Ln(...t){let e=Xh;for(let n of t)e=e.insert(n.key,n);return e}function t_(t){let e=Xh;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function at(){return Un()}function Zh(){return Un()}function Un(){return new ze(t=>t.toString(),(t,e)=>t.isEqual(e))}var Xv=new F(v.comparator),n_=new ie(v.comparator);function C(...t){let e=n_;for(let n of t)e=e.add(n);return e}var r_=new ie(k);function i_(){return r_}function s_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gi(e)?"-0":e}}function o_(t){return{integerValue:""+t}}var Gt=class{constructor(){this._=void 0}};function a_(t,e,n){return t instanceof jn?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&pc(s)&&(s=mc(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Wt?ed(t,e):t instanceof Kt?td(t,e):function(i,s){let o=u_(i,s),a=wh(o)+wh(i.Ie);return Xo(o)&&Xo(i.Ie)?o_(a):s_(i.serializer,a)}(t,e)}function c_(t,e,n){return t instanceof Wt?ed(t,e):t instanceof Kt?td(t,e):n}function u_(t,e){return t instanceof Gn?function(r){return Xo(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var jn=class extends Gt{},Wt=class extends Gt{constructor(e){super(),this.elements=e}};function ed(t,e){let n=nd(e);for(let r of t.elements)n.some(i=>Se(i,r))||n.push(r);return{arrayValue:{values:n}}}var Kt=class extends Gt{constructor(e){super(),this.elements=e}};function td(t,e){let n=nd(e);for(let r of t.elements)n=n.filter(i=>!Se(i,r));return{arrayValue:{values:n}}}var Gn=class extends Gt{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function wh(t){return M(t.integerValue||t.doubleValue)}function nd(t){return gc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function l_(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Wt&&i instanceof Wt||r instanceof Kt&&i instanceof Kt?Ut(r.elements,i.elements,Se):r instanceof Gn&&i instanceof Gn?Se(r.Ie,i.Ie):r instanceof jn&&i instanceof jn}(t.transform,e.transform)}var qn=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function di(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Wn=class{};function rd(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new la(t.key,qn.none()):new Kn(t.key,t.data,qn.none());{let n=t.data,r=De.empty(),i=new ie(ge.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Ht(t.key,r,new ot(i.toArray()),qn.none())}}function h_(t,e,n){t instanceof Kn?function(i,s,o){let a=i.value.clone(),c=Ah(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ht?function(i,s,o){if(!di(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=Ah(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(id(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Bn(t,e,n,r){return t instanceof Kn?function(s,o,a,c){if(!di(s.precondition,o))return a;let u=s.value.clone(),l=Sh(s.fieldTransforms,c,o);return u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ht?function(s,o,a,c){if(!di(s.precondition,o))return a;let u=Sh(s.fieldTransforms,c,o),l=o.data;return l.setAll(id(s)),l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,o,a){return di(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function Th(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ut(r,i,(s,o)=>l_(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Kn=class extends Wn{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Ht=class extends Wn{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function id(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function Ah(t,e,n){let r=new Map;j(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,c_(o,a,n[i]))}return r}function Sh(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,a_(s,o,e))}return r}var la=class extends Wn{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};var ha=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&h_(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Bn(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Bn(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=Zh();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=rd(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(A.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),C())}isEqual(e){return this.batchId===e.batchId&&Ut(this.mutations,e.mutations,(n,r)=>Th(n,r))&&Ut(this.baseMutations,e.baseMutations,(n,r)=>Th(n,r))}};var da=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var fa=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var U,P;function sd(t){if(t===void 0)return ke("GRPC error has no .code"),_.UNKNOWN;switch(t){case U.OK:return _.OK;case U.CANCELLED:return _.CANCELLED;case U.UNKNOWN:return _.UNKNOWN;case U.DEADLINE_EXCEEDED:return _.DEADLINE_EXCEEDED;case U.RESOURCE_EXHAUSTED:return _.RESOURCE_EXHAUSTED;case U.INTERNAL:return _.INTERNAL;case U.UNAVAILABLE:return _.UNAVAILABLE;case U.UNAUTHENTICATED:return _.UNAUTHENTICATED;case U.INVALID_ARGUMENT:return _.INVALID_ARGUMENT;case U.NOT_FOUND:return _.NOT_FOUND;case U.ALREADY_EXISTS:return _.ALREADY_EXISTS;case U.PERMISSION_DENIED:return _.PERMISSION_DENIED;case U.FAILED_PRECONDITION:return _.FAILED_PRECONDITION;case U.ABORTED:return _.ABORTED;case U.OUT_OF_RANGE:return _.OUT_OF_RANGE;case U.UNIMPLEMENTED:return _.UNIMPLEMENTED;case U.DATA_LOSS:return _.DATA_LOSS;default:return T()}}(P=U||(U={}))[P.OK=0]="OK",P[P.CANCELLED=1]="CANCELLED",P[P.UNKNOWN=2]="UNKNOWN",P[P.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",P[P.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",P[P.NOT_FOUND=5]="NOT_FOUND",P[P.ALREADY_EXISTS=6]="ALREADY_EXISTS",P[P.PERMISSION_DENIED=7]="PERMISSION_DENIED",P[P.UNAUTHENTICATED=16]="UNAUTHENTICATED",P[P.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",P[P.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",P[P.ABORTED=10]="ABORTED",P[P.OUT_OF_RANGE=11]="OUT_OF_RANGE",P[P.UNIMPLEMENTED=12]="UNIMPLEMENTED",P[P.INTERNAL=13]="INTERNAL",P[P.UNAVAILABLE=14]="UNAVAILABLE",P[P.DATA_LOSS=15]="DATA_LOSS";var bh=null;function d_(){return new TextEncoder}var f_=new st([4294967295,4294967295],0);function Rh(t){let e=d_().encode(t),n=new dh;return n.update(e),new Uint8Array(n.digest())}function Ph(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new st([n,r],0),new st([i,s],0)]}var pa=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ct(`Invalid padding: ${n}`);if(r<0)throw new ct(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ct(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ct(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=st.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(st.fromNumber(r)));return i.compare(f_)===1&&(i=new st([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=Rh(e),[r,i]=Ph(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=Rh(e),[r,i]=Ph(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},ct=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ei=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,Hn.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(A.min(),i,new F(k),je(),C())}},Hn=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,C(),C(),C())}};var xt=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},wi=class{constructor(e,n){this.targetId=e,this.fe=n}},Ti=class{constructor(e,n,r=oe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},Ai=class{constructor(){this.ge=0,this.pe=Dh(),this.ye=oe.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=C(),n=C(),r=C();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:T()}}),new Hn(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=Dh()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1}Be(){this.Se=!0,this.we=!0}},ma=class{constructor(e){this.Le=e,this.ke=new Map,this.qe=je(),this.Qe=Ch(),this.Ke=new F(k)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:T()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(ca(s))if(r===0){let o=new v(s.path);this.We(n,o,_e.newNoDocument(o,A.min()))}else j(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),c=a?this.et(a,e,o):1;if(c!==0){this.He(n);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}bh?.tt(function(l,h,f,m,b){var R,w,V,Z,Q,ee;let fe={localCacheCount:l,existenceFilterCount:h.count,databaseId:f.database,projectId:f.projectId},Y=h.unchangedNames;return Y&&(fe.bloomFilter={applied:b===0,hashCount:(R=Y?.hashCount)!==null&&R!==void 0?R:0,bitmapLength:(Z=(V=(w=Y?.bits)===null||w===void 0?void 0:w.bitmap)===null||V===void 0?void 0:V.length)!==null&&Z!==void 0?Z:0,padding:(ee=(Q=Y?.bits)===null||Q===void 0?void 0:Q.padding)!==null&&ee!==void 0?ee:0,mightContain:Ge=>{var pt;return(pt=m?.mightContain(Ge))!==null&&pt!==void 0&&pt}}),fe}(o,e.fe,this.Le.nt(),a,c))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=$e(r).toUint8Array()}catch(c){if(c instanceof yi)return Ft("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new pa(o,i,s)}catch(c){return Ft(c instanceof ct?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&ca(a.target)){let c=new v(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,_e.newNoDocument(c,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=C();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.Ye(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new Ei(e,n,this.Ke,this.qe,r);return this.qe=je(),this.Qe=Ch(),this.Ke=new F(k),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new Ai,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new ie(k),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||y("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Ai),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function Ch(){return new F(v.comparator)}function Dh(){return new F(v.comparator)}var p_=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),m_=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),g_=(()=>({and:"AND",or:"OR"}))(),ga=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function _a(t,e){return t.useProto3Json||qi(e)?e:{value:e}}function __(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function y_(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Vt(t){return j(!!t),A.fromTimestamp(function(n){let r=Be(n);return new de(r.seconds,r.nanos)}(t))}function I_(t,e){return function(r){return new B(["projects",r.projectId,"databases",r.database])}(t).child("documents").child(e).canonicalString()}function od(t){let e=B.fromString(t);return j(ld(e)),e}function Lo(t,e){let n=od(e);if(n.get(1)!==t.databaseId.projectId)throw new I(_.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new I(_.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new v(ad(n))}function ya(t,e){return I_(t.databaseId,e)}function v_(t){let e=od(t);return e.length===4?B.emptyPath():ad(e)}function kh(t){return new B(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ad(t){return j(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function E_(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:T()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,l){return u.useProto3Json?(j(l===void 0||typeof l=="string"),oe.fromBase64String(l||"")):(j(l===void 0||l instanceof Uint8Array),oe.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){let l=u.code===void 0?_.UNKNOWN:sd(u.code);return new I(l,u.message||"")}(o);n=new Ti(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Lo(t,r.document.name),s=Vt(r.document.updateTime),o=r.document.createTime?Vt(r.document.createTime):A.min(),a=new De({mapValue:{fields:r.document.fields}}),c=_e.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new xt(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Lo(t,r.document),s=r.readTime?Vt(r.readTime):A.min(),o=_e.newNoDocument(i,s),a=r.removedTargetIds||[];n=new xt([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Lo(t,r.document),s=r.removedTargetIds||[];n=new xt([],s,i,null)}else{if(!("filter"in e))return T();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new fa(i,s),a=r.targetId;n=new wi(a,o)}}return n}function w_(t,e){return{documents:[ya(t,e.path)]}}function T_(t,e){let n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=ya(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ya(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);let i=function(c){if(c.length!==0)return ud(be.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);let s=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:kt(h.field),direction:b_(h.dir)}}(u))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);let o=_a(t,e.limit);return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function A_(t){let e=v_(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){j(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(h){let f=cd(h);return f instanceof be&&Wh(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(b){return new zt(Nt(b.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,qi(f)?null:f}(n.limit));let c=null;n.startAt&&(c=function(h){let f=!!h.before,m=h.values||[];return new $t(m,f)}(n.startAt));let u=null;return n.endAt&&(u=function(h){let f=!h.before,m=h.values||[];return new $t(m,f)}(n.endAt)),Qg(e,i,o,s,a,"F",c,u)}function S_(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return T()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function cd(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Nt(n.unaryFilter.field);return z.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Nt(n.unaryFilter.field);return z.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Nt(n.unaryFilter.field);return z.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Nt(n.unaryFilter.field);return z.create(o,"!=",{nullValue:"NULL_VALUE"});default:return T()}}(t):t.fieldFilter!==void 0?function(n){return z.create(Nt(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return T()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return be.create(n.compositeFilter.filters.map(r=>cd(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return T()}}(n.compositeFilter.op))}(t):T()}function b_(t){return p_[t]}function R_(t){return m_[t]}function P_(t){return g_[t]}function kt(t){return{fieldPath:t.canonicalString()}}function Nt(t){return ge.fromServerFormat(t.fieldPath)}function ud(t){return t instanceof z?function(n){if(n.op==="=="){if(_h(n.value))return{unaryFilter:{field:kt(n.field),op:"IS_NAN"}};if(gh(n.value))return{unaryFilter:{field:kt(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(_h(n.value))return{unaryFilter:{field:kt(n.field),op:"IS_NOT_NAN"}};if(gh(n.value))return{unaryFilter:{field:kt(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:kt(n.field),op:R_(n.op),value:n.value}}}(t):t instanceof be?function(n){let r=n.getFilters().map(i=>ud(i));return r.length===1?r[0]:{compositeFilter:{op:P_(n.op),filters:r}}}(t):T()}function ld(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Qn=class t{constructor(e,n,r,i,s=A.min(),o=A.min(),a=oe.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Ia=class{constructor(e){this.ut=e}};function C_(t){let e=A_({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ua(e,e.limit,"L"):e}var Si=class{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(M(e.integerValue));else if("doubleValue"in e){let r=M(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),gi(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Tt(n,20),typeof r=="string"?n.dt(r):(n.dt(`${r.seconds||""}`),n.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt($e(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?jh(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):T()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){let r=e.fields||{};this.Tt(n,55);for(let i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){let r=e.values||[];this.Tt(n,50);for(let i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),v.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}};Si.St=new Si;var va=class{constructor(){this.on=new Ea}addToCollectionParentIndex(e,n){return this.on.add(n),p.resolve()}getCollectionParents(e,n){return p.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return p.resolve()}deleteFieldIndex(e,n){return p.resolve()}deleteAllFieldIndexes(e){return p.resolve()}createTargetIndexes(e,n){return p.resolve()}getDocumentsMatchingTarget(e,n){return p.resolve(null)}getIndexType(e,n){return p.resolve(0)}getFieldIndexes(e,n){return p.resolve([])}getNextCollectionGroupToUpdate(e){return p.resolve(null)}getMinOffset(e,n){return p.resolve(ht.min())}getMinOffsetFromCollectionGroup(e,n){return p.resolve(ht.min())}updateCollectionGroup(e,n,r){return p.resolve()}updateIndexEntries(e,n){return p.resolve()}},Ea=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new ie(B.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ie(B.comparator)).toArray()}};var Zv=new Uint8Array(0);var we=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};we.DEFAULT_COLLECTION_PERCENTILE=10,we.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,we.DEFAULT=new we(41943040,we.DEFAULT_COLLECTION_PERCENTILE,we.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),we.DISABLED=new we(-1,0,0);var Yn=class t{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new t(0)}static Nn(){return new t(-1)}};var wa=class{constructor(){this.changes=new ze(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,_e.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?p.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ta=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Aa=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Bn(r.mutation,i,ot.empty(),de.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,C()).next(()=>r))}getLocalViewOfDocuments(e,n,r=C()){let i=at();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Ln();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=at();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,C()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=je(),o=Un(),a=function(){return Un()}();return n.forEach((c,u)=>{let l=r.get(u.key);i.has(u.key)&&(l===void 0||l.mutation instanceof Ht)?s=s.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),Bn(l.mutation,u,l.mutation.getFieldMask(),de.now())):o.set(u.key,ot.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,l)=>o.set(u,l)),n.forEach((u,l)=>{var h;return a.set(u,new Ta(l,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){let r=Un(),i=new F((o,a)=>o-a),s=C();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=n.get(c);if(u===null)return;let l=r.get(c)||ot.empty();l=a.applyToLocalView(u,l),r.set(c,l);let h=(i.get(a.batchId)||C()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,l=c.value,h=Zh();l.forEach(f=>{if(!s.has(f)){let m=rd(n.get(f),r.get(f));m!==null&&h.set(f,m),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return p.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return v.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Yg(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):p.resolve(at()),a=-1,c=s;return o.next(u=>p.forEach(u,(l,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(l)?p.resolve():this.remoteDocumentCache.getEntry(e,l).next(f=>{c=c.insert(l,f)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,C())).next(l=>({batchId:a,changes:t_(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new v(n)).next(r=>{let i=Ln();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=Ln();return this.indexManager.getCollectionParents(e,s).next(a=>p.forEach(a,c=>{let u=function(h,f){return new jt(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(l=>{l.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{let l=u.getKey();o.get(l)===null&&(o=o.insert(l,_e.newInvalidDocument(l)))});let a=Ln();return o.forEach((c,u)=>{let l=s.get(c);l!==void 0&&Bn(l.mutation,u,ot.empty(),de.now()),zi(n,u)&&(a=a.insert(c,u))}),a})}};var Sa=class{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return p.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Vt(i.createTime)}}(n)),p.resolve()}getNamedQuery(e,n){return p.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(i){return{name:i.name,query:C_(i.bundledQuery),readTime:Vt(i.readTime)}}(n)),p.resolve()}};var ba=class{constructor(){this.overlays=new F(v.comparator),this.lr=new Map}getOverlay(e,n){return p.resolve(this.overlays.get(n))}getOverlays(e,n){let r=at();return p.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),p.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.lr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),p.resolve()}getOverlaysForCollection(e,n,r){let i=at(),s=n.length+1,o=new v(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return p.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new F((u,l)=>u-l),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let l=s.get(u.largestBatchId);l===null&&(l=at(),s=s.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}let a=at(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=i)););return p.resolve(a)}lt(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new da(n,r));let s=this.lr.get(n);s===void 0&&(s=C(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}};var Jn=class{constructor(){this.hr=new ie(q.Pr),this.Ir=new ie(q.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){let r=new q(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new q(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){let n=new v(new B([])),r=new q(n,e),i=new q(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){let n=new v(new B([])),r=new q(n,e),i=new q(n,e+1),s=C();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new q(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},q=class{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return v.comparator(e.key,n.key)||k(e.gr,n.gr)}static Tr(e,n){return k(e.gr,n.gr)||v.comparator(e.key,n.key)}};var Ra=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new ie(q.Pr)}checkEmpty(e){return p.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new ha(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.yr=this.yr.add(new q(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return p.resolve(o)}lookupMutationBatch(e,n){return p.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.Sr(r),s=i<0?0:i;return p.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return p.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return p.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new q(n,0),i=new q(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{let a=this.wr(o.gr);s.push(a)}),p.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ie(k);return n.forEach(i=>{let s=new q(i,0),o=new q(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),p.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;v.isDocumentKey(s)||(s=s.child(""));let o=new q(new v(s),0),a=new ie(k);return this.yr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.gr)),!0)},o),p.resolve(this.br(a))}br(e){let n=[];return e.forEach(r=>{let i=this.wr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){j(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return p.forEach(n.mutations,i=>{let s=new q(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){let r=new q(n,0),i=this.yr.firstAfterOrEqual(r);return p.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,p.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){let n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var Pa=class{constructor(e){this.Cr=e,this.docs=function(){return new F(v.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return p.resolve(r?r.document.mutableCopy():_e.newInvalidDocument(n))}getEntries(e,n){let r=je();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():_e.newInvalidDocument(i))}),p.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=je(),o=n.path,a=new v(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||qg(Ug(l),r)<=0||(i.has(l.key)||zi(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return p.resolve(s)}getAllFromCollectionGroup(e,n,r,i){T()}vr(e,n){return p.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Ca(this)}getSize(e){return p.resolve(this.size)}},Ca=class extends wa{constructor(e){super(),this._r=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),p.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}};var Da=class{constructor(e){this.persistence=e,this.Fr=new ze(n=>_c(n),yc),this.lastRemoteSnapshotVersion=A.min(),this.highestTargetId=0,this.Mr=0,this.Or=new Jn,this.targetCount=0,this.Nr=Yn.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),p.resolve()}getLastRemoteSnapshotVersion(e){return p.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return p.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),p.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),p.resolve()}kn(e){this.Fr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Nr=new Yn(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,p.resolve()}updateTargetData(e,n){return this.kn(n),p.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,p.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),p.waitFor(s).next(()=>i)}getTargetCount(e){return p.resolve(this.targetCount)}getTargetData(e,n){let r=this.Fr.get(n)||null;return p.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),p.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),p.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),p.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Or.mr(n);return p.resolve(r)}containsKey(e,n){return p.resolve(this.Or.containsKey(n))}};var ka=class{constructor(e,n){this.Br={},this.overlays={},this.Lr=new zh(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new Da(this),this.indexManager=new va,this.remoteDocumentCache=function(i){return new Pa(i)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new Ia(n),this.Kr=new Sa(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new ba,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new Ra(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){y("MemoryPersistence","Starting transaction:",e);let i=new Na(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return p.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}},Na=class extends Qo{constructor(e){super(),this.currentSequenceNumber=e}},Oa=class t{constructor(e){this.persistence=e,this.Gr=new Jn,this.zr=null}static jr(e){return new t(e)}get Hr(){if(this.zr)return this.zr;throw T()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),p.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),p.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),p.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return p.forEach(this.Hr,r=>{let i=v.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,A.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return p.or([()=>p.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}};var xa=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=C(),i=C();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var Va=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var La=class{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Va;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(Vn()<=S.DEBUG&&y("QueryEngine","SDK will not create cache indexes for query:",Dt(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),p.resolve()):(Vn()<=S.DEBUG&&y("QueryEngine","Query:",Dt(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(Vn()<=S.DEBUG&&y("QueryEngine","The SDK decides to create cache indexes for query:",Dt(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ae(n))):p.resolve())}zi(e,n){if(Eh(n))return p.resolve(null);let r=Ae(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=ua(n,null,"F"),r=Ae(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=C(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.Yi(n,a);return this.Zi(n,u,o,c.readTime)?this.zi(e,ua(n,null,"F")):this.Xi(e,u,n,c)}))})))}ji(e,n,r,i){return Eh(n)||i.isEqual(A.min())?p.resolve(null):this.Gi.getDocuments(e,r).next(s=>{let o=this.Yi(n,s);return this.Zi(n,o,r,i)?p.resolve(null):(Vn()<=S.DEBUG&&y("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Dt(n)),this.Xi(e,o,n,Fg(i,-1)).next(a=>a))})}Yi(e,n){let r=new ie(Jh(e));return n.forEach((i,s)=>{zi(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return Vn()<=S.DEBUG&&y("QueryEngine","Using full collection scan to execute query:",Dt(n)),this.Gi.getDocumentsMatchingQuery(e,n,ht.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Ma=class{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new F(k),this.ns=new ze(s=>_c(s),yc),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Aa(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}};function D_(t,e,n,r){return new Ma(t,e,n,r)}function hd(t,e){return d(this,null,function*(){let n=D(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=C();for(let u of i){o.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}for(let u of s){a.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}return n.localDocuments.getDocuments(r,c).next(u=>({_s:u,removedBatchIds:o,addedBatchIds:a}))})})})}function dd(t){let e=D(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function k_(t,e){let n=D(t),r=e.snapshotVersion,i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;let a=[];e.targetChanges.forEach((l,h)=>{let f=i.get(h);if(!f)return;a.push(n.qr.removeMatchingKeys(s,l.removedDocuments,h).next(()=>n.qr.addMatchingKeys(s,l.addedDocuments,h)));let m=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(oe.EMPTY_BYTE_STRING,A.min()).withLastLimboFreeSnapshotVersion(A.min()):l.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(l.resumeToken,r)),i=i.insert(h,m),function(R,w,V){return R.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=3e8?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0}(f,m,l)&&a.push(n.qr.updateTargetData(s,m))});let c=je(),u=C();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(N_(s,o,e.documentUpdates).next(l=>{c=l.us,u=l.cs})),!r.isEqual(A.min())){let l=n.qr.getLastRemoteSnapshotVersion(s).next(h=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return p.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.ts=i,s))}function N_(t,e,n){let r=C(),i=C();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=je();return n.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(A.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):y("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{us:o,cs:i}})}function O_(t,e){let n=D(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,p.resolve(i)):n.qr.allocateTargetId(r).next(o=>(i=new Qn(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}function Fa(t,e,n){return d(this,null,function*(){let r=D(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!er(o))throw o;y("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)})}function Nh(t,e,n){let r=D(t),i=A.min(),s=C();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,l){let h=D(c),f=h.ns.get(l);return f!==void 0?p.resolve(h.ts.get(f)):h.qr.getTargetData(u,l)}(r,o,Ae(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?i:A.min(),n?s:C())).next(a=>(x_(r,Xg(e),a),{documents:a,ls:s})))}function x_(t,e,n){let r=t.rs.get(e)||A.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}var bi=class{constructor(){this.activeTargetIds=i_()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Ua=class{constructor(){this.eo=new bi,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new bi,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var qa=class{ro(e){}shutdown(){}};var Ri=class{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){y("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ao)e(0)}_o(){y("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var hi=null;function Mo(){return hi===null?hi=function(){return 268435456+Math.round(2147483648*Math.random())}():hi++,"0x"+hi.toString(16)}var V_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Ba=class{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}};var re="WebChannelConnection",$a=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(n,r,i,s,o){let a=Mo(),c=this.So(n,r);y("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(u,s,o),this.Do(n,c,u,i).then(l=>(y("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Ft("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",c,"request:",i),l})}Co(n,r,i,s,o,a){return this.wo(n,r,i,s,o)}bo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Yt}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}So(n,r){let i=V_[n];return`${this.mo}/v1/${r}:${i}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,i){let s=Mo();return new Promise((o,a)=>{let c=new hh;c.setWithCredentials(!0),c.listenOnce(ch.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case ui.NO_ERROR:let l=c.getResponseJson();y(re,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case ui.TIMEOUT:y(re,`RPC '${e}' ${s} timed out`),a(new I(_.DEADLINE_EXCEEDED,"Request time out"));break;case ui.HTTP_ERROR:let h=c.getStatus();if(y(re,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);let m=f?.error;if(m&&m.status&&m.message){let b=function(w){let V=w.toLowerCase().replace(/_/g,"-");return Object.values(_).indexOf(V)>=0?V:_.UNKNOWN}(m.status);a(new I(b,m.message))}else a(new I(_.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new I(_.UNAVAILABLE,"Connection failed."));break;default:T()}}finally{y(re,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);y(re,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}vo(e,n,r){let i=Mo(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=oh(),a=ah(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.xmlHttpFactory=new lh({})),this.bo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let l=s.join("");y(re,`Creating RPC '${e}' stream ${i}: ${l}`,c);let h=o.createWebChannel(l,c),f=!1,m=!1,b=new Ba({co:w=>{m?y(re,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(f||(y(re,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),y(re,`RPC '${e}' stream ${i} sending:`,w),h.send(w))},lo:()=>h.close()}),R=(w,V,Z)=>{w.listen(V,Q=>{try{Z(Q)}catch(ee){setTimeout(()=>{throw ee},0)}})};return R(h,xn.EventType.OPEN,()=>{m||y(re,`RPC '${e}' stream ${i} transport opened.`)}),R(h,xn.EventType.CLOSE,()=>{m||(m=!0,y(re,`RPC '${e}' stream ${i} transport closed`),b.Ro())}),R(h,xn.EventType.ERROR,w=>{m||(m=!0,Ft(re,`RPC '${e}' stream ${i} transport errored:`,w),b.Ro(new I(_.UNAVAILABLE,"The operation could not be completed")))}),R(h,xn.EventType.MESSAGE,w=>{var V;if(!m){let Z=w.data[0];j(!!Z);let Q=Z,ee=Q.error||((V=Q[0])===null||V===void 0?void 0:V.error);if(ee){y(re,`RPC '${e}' stream ${i} received error:`,ee);let fe=ee.status,Y=function(Xt){let ir=U[Xt];if(ir!==void 0)return sd(ir)}(fe),Ge=ee.message;Y===void 0&&(Y=_.INTERNAL,Ge="Unknown error status: "+fe+" with message "+ee.message),m=!0,b.Ro(new I(Y,Ge)),h.close()}else y(re,`RPC '${e}' stream ${i} received:`,Z),b.Vo(Z)}}),R(a,uh.STAT_EVENT,w=>{w.stat===xo.PROXY?y(re,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===xo.NOPROXY&&y(re,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{b.Ao()},0),b}};function Fo(){return typeof document<"u"?document:null}function fd(t){return new ga(t,!0)}var Pi=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();let n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&y("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}};var za=class{constructor(e,n,r,i,s,o,a,c){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new Pi(e,n)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}stop(){return d(this,null,function*(){this.jo()&&(yield this.close(0))})}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){return d(this,null,function*(){if(this.Ho())return this.close(0)})}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,n){return d(this,null,function*(){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,e!==4?this.zo.reset():n&&n.code===_.RESOURCE_EXHAUSTED?(ke(n.toString()),ke("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):n&&n.code===_.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Io(n)})}r_(){}auth(){this.state=1;let e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===n&&this.s_(r,i)},r=>{e(()=>{let i=new I(_.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,n){let r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(()=>d(this,null,function*(){this.state=0,this.start()}))}o_(e){return y("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(y("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},ja=class extends za{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();let n=E_(this.serializer,e),r=function(s){if(!("targetChange"in s))return A.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?A.min():o.readTime?Vt(o.readTime):A.min()}(e);return this.listener.a_(n,r)}u_(e){let n={};n.database=kh(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=ca(c)?{documents:w_(s,c)}:{query:T_(s,c)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=y_(s,o.resumeToken);let u=_a(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(A.min())>0){a.readTime=__(s,o.snapshotVersion.toTimestamp());let u=_a(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=S_(this.serializer,e);r&&(n.labels=r),this.e_(n)}c_(e){let n={};n.database=kh(this.serializer),n.removeTarget=e,this.e_(n)}};var Ga=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new I(_.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===_.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new I(_.UNKNOWN,i.toString())})}Co(e,n,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,n,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===_.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new I(_.UNKNOWN,s.toString())})}terminate(){this.d_=!0}};var Wa=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,e==="Online"&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(ke(n),this.f_=!1):y("OnlineStateTracker",n)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}};var Ka=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(o=>{r.enqueueAndForget(()=>d(this,null,function*(){nr(this)&&(y("RemoteStore","Restarting streams for network reachability change."),yield function(c){return d(this,null,function*(){let u=D(c);u.C_.add(4),yield tr(u),u.M_.set("Unknown"),u.C_.delete(4),yield ji(u)})}(this))}))}),this.M_=new Wa(r,i)}};function ji(t){return d(this,null,function*(){if(nr(t))for(let e of t.v_)yield e(!0)})}function tr(t){return d(this,null,function*(){for(let e of t.v_)yield e(!1)})}function pd(t,e){let n=D(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),wc(n)?Ec(n):Jt(n).Ho()&&vc(n,e))}function md(t,e){let n=D(t),r=Jt(n);n.D_.delete(e),r.Ho()&&gd(n,e),n.D_.size===0&&(r.Ho()?r.Zo():nr(n)&&n.M_.set("Unknown"))}function vc(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(A.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Jt(t).u_(e)}function gd(t,e){t.x_.Oe(e),Jt(t).c_(e)}function Ec(t){t.x_=new ma({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Jt(t).start(),t.M_.g_()}function wc(t){return nr(t)&&!Jt(t).jo()&&t.D_.size>0}function nr(t){return D(t).C_.size===0}function _d(t){t.x_=void 0}function L_(t){return d(this,null,function*(){t.D_.forEach((e,n)=>{vc(t,e)})})}function M_(t,e){return d(this,null,function*(){_d(t),wc(t)?(t.M_.w_(e),Ec(t)):t.M_.set("Unknown")})}function F_(t,e,n){return d(this,null,function*(){if(t.M_.set("Online"),e instanceof Ti&&e.state===2&&e.cause)try{yield function(i,s){return d(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.D_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.D_.delete(a),i.x_.removeTarget(a))})}(t,e)}catch(r){y("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Oh(t,r)}else if(e instanceof xt?t.x_.$e(e):e instanceof wi?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(A.min()))try{let r=yield dd(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.x_.it(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let l=s.D_.get(u);l&&s.D_.set(u,l.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let l=s.D_.get(c);if(!l)return;s.D_.set(c,l.withResumeToken(oe.EMPTY_BYTE_STRING,l.snapshotVersion)),gd(s,c);let h=new Qn(l.target,c,u,l.sequenceNumber);vc(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){y("RemoteStore","Failed to raise snapshot:",r),yield Oh(t,r)}})}function Oh(t,e,n){return d(this,null,function*(){if(!er(e))throw e;t.C_.add(1),yield tr(t),t.M_.set("Offline"),n||(n=()=>dd(t.localStore)),t.asyncQueue.enqueueRetryable(()=>d(this,null,function*(){y("RemoteStore","Retrying IndexedDB access"),yield n(),t.C_.delete(1),yield ji(t)}))})}function xh(t,e){return d(this,null,function*(){let n=D(t);n.asyncQueue.verifyOperationInProgress(),y("RemoteStore","RemoteStore received new credentials");let r=nr(n);n.C_.add(3),yield tr(n),r&&n.M_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),yield ji(n)})}function U_(t,e){return d(this,null,function*(){let n=D(t);e?(n.C_.delete(2),yield ji(n)):e||(n.C_.add(2),yield tr(n),n.M_.set("Unknown"))})}function Jt(t){return t.O_||(t.O_=function(n,r,i){let s=D(n);return s.A_(),new ja(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:L_.bind(null,t),Io:M_.bind(null,t),a_:F_.bind(null,t)}),t.v_.push(e=>d(this,null,function*(){e?(t.O_.Yo(),wc(t)?Ec(t):t.M_.set("Unknown")):(yield t.O_.stop(),_d(t))}))),t.O_}var Ha=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new qe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new I(_.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function yd(t,e){if(ke("AsyncQueue",`${e}: ${t}`),er(t))return new I(_.UNAVAILABLE,`${e}: ${t}`);throw t}var Ci=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||v.comparator(n.key,r.key):(n,r)=>v.comparator(n.key,r.key),this.keyedMap=Ln(),this.sortedSet=new F(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var Di=class{constructor(){this.B_=new F(v.comparator)}track(e){let n=e.doc.key,r=this.B_.get(n);r?e.type!==0&&r.type===3?this.B_=this.B_.insert(n,e):e.type===3&&r.type!==1?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.B_=this.B_.remove(n):e.type===1&&r.type===2?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):T():this.B_=this.B_.insert(n,e)}L_(){let e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}},Qt=class t{constructor(e,n,r,i,s,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,Ci.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$i(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var Qa=class{constructor(){this.k_=void 0,this.listeners=[]}},Ya=class{constructor(){this.queries=new ze(e=>Yh(e),$i),this.onlineState="Unknown",this.q_=new Set}};function q_(t,e){return d(this,null,function*(){let n=D(t),r=e.query,i=!1,s=n.queries.get(r);if(s||(i=!0,s=new Qa),i)try{s.k_=yield n.onListen(r)}catch(o){let a=yd(o,`Initialization of query '${Dt(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&Tc(n)})}function B_(t,e){return d(this,null,function*(){let n=D(t),r=e.query,i=!1,s=n.queries.get(r);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}function $_(t,e){let n=D(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.listeners)a.K_(i)&&(r=!0);o.k_=i}}r&&Tc(n)}function z_(t,e,n){let r=D(t),i=r.queries.get(e);if(i)for(let s of i.listeners)s.onError(n);r.queries.delete(e)}function Tc(t){t.q_.forEach(e=>{e.next()})}var Ja=class{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Qt(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){if(!e.fromCache)return!0;let r=n!=="Offline";return(!this.options.J_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}z_(e){if(e.docChanges.length>0)return!0;let n=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}H_(e){e=Qt.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}};var ki=class{constructor(e){this.key=e}},Ni=class{constructor(e){this.key=e}},Xa=class{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=C(),this.mutatedKeys=C(),this._a=Jh(e),this.aa=new Ci(this._a)}get ua(){return this.ia}ca(e,n){let r=n?n.la:new Di,i=n?n.aa:this.aa,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,h)=>{let f=i.get(l),m=zi(this.query,h)?h:null,b=!!f&&this.mutatedKeys.has(f.key),R=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations),w=!1;f&&m?f.data.isEqual(m.data)?b!==R&&(r.track({type:3,doc:m}),w=!0):this.ha(f,m)||(r.track({type:2,doc:m}),w=!0,(c&&this._a(m,c)>0||u&&this._a(m,u)<0)&&(a=!0)):!f&&m?(r.track({type:0,doc:m}),w=!0):f&&!m&&(r.track({type:1,doc:f}),w=!0,(c||u)&&(a=!0)),w&&(m?(o=o.add(m),s=R?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{aa:o,la:r,Zi:a,mutatedKeys:s}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){let i=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;let s=e.la.L_();s.sort((u,l)=>function(f,m){let b=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return T()}};return b(f)-b(m)}(u.type,l.type)||this._a(u.doc,l.doc)),this.Pa(r);let o=n?this.Ia():[],a=this.oa.size===0&&this.current?1:0,c=a!==this.sa;return this.sa=a,s.length!==0||c?{snapshot:new Qt(this.query,e.aa,i,s,e.mutatedKeys,a===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:o}:{Ta:o}}Q_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new Di,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];let e=this.oa;this.oa=C(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});let n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new Ni(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new ki(r))}),n}da(e){this.ia=e.ls,this.oa=C();let n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return Qt.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}},Za=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},ec=class{constructor(e){this.key=e,this.Ra=!1}},tc=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new ze(a=>Yh(a),$i),this.fa=new Map,this.ga=new Set,this.pa=new F(v.comparator),this.ya=new Map,this.wa=new Jn,this.Sa={},this.ba=new Map,this.Da=Yn.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}};function j_(t,e){return d(this,null,function*(){let n=J_(t),r,i,s=n.ma.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{let o=yield O_(n.localStore,Ae(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield G_(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&pd(n.remoteStore,o)}return i})}function G_(t,e,n,r,i){return d(this,null,function*(){t.va=(h,f,m)=>function(R,w,V,Z){return d(this,null,function*(){let Q=w.view.ca(V);Q.Zi&&(Q=yield Nh(R.localStore,w.query,!1).then(({documents:Y})=>w.view.ca(Y,Q)));let ee=Z&&Z.targetChanges.get(w.targetId),fe=w.view.applyChanges(Q,R.isPrimaryClient,ee);return Lh(R,w.targetId,fe.Ta),fe.snapshot})}(t,h,f,m);let s=yield Nh(t.localStore,e,!0),o=new Xa(e,s.ls),a=o.ca(s.documents),c=Hn.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,c);Lh(t,n,u.Ta);let l=new Za(e,n,o);return t.ma.set(e,l),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),u.snapshot})}function W_(t,e){return d(this,null,function*(){let n=D(t),r=n.ma.get(e),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter(s=>!$i(s,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Fa(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),md(n.remoteStore,r.targetId),nc(n,r.targetId)}).catch(fc))):(nc(n,r.targetId),yield Fa(n.localStore,r.targetId,!0))})}function Id(t,e){return d(this,null,function*(){let n=D(t);try{let r=yield k_(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.ya.get(s);o&&(j(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ra=!0:i.modifiedDocuments.size>0?j(o.Ra):i.removedDocuments.size>0&&(j(o.Ra),o.Ra=!1))}),yield Ed(n,r,e)}catch(r){yield fc(r)}})}function Vh(t,e,n){let r=D(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ma.forEach((s,o)=>{let a=o.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=D(o);c.onlineState=a;let u=!1;c.queries.forEach((l,h)=>{for(let f of h.listeners)f.Q_(a)&&(u=!0)}),u&&Tc(c)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function K_(t,e,n){return d(this,null,function*(){let r=D(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.ya.get(e),s=i&&i.key;if(s){let o=new F(v.comparator);o=o.insert(s,_e.newNoDocument(s,A.min()));let a=C().add(s),c=new Ei(A.min(),new Map,new F(k),o,a);yield Id(r,c),r.pa=r.pa.remove(s),r.ya.delete(e),Ac(r)}else yield Fa(r.localStore,e,!1).then(()=>nc(r,e,n)).catch(fc)})}function nc(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||vd(t,r)})}function vd(t,e){t.ga.delete(e.path.canonicalString());let n=t.pa.get(e);n!==null&&(md(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),Ac(t))}function Lh(t,e,n){for(let r of n)r instanceof ki?(t.wa.addReference(r.key,e),H_(t,r)):r instanceof Ni?(y("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||vd(t,r.key)):T()}function H_(t,e){let n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(y("SyncEngine","New document in limbo: "+n),t.ga.add(r),Ac(t))}function Ac(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){let e=t.ga.values().next().value;t.ga.delete(e);let n=new v(B.fromString(e)),r=t.Da.next();t.ya.set(r,new ec(n)),t.pa=t.pa.insert(n,r),pd(t.remoteStore,new Qn(Ae(Ic(n.path)),r,"TargetPurposeLimboResolution",zh._e))}}function Ed(t,e,n){return d(this,null,function*(){let r=D(t),i=[],s=[],o=[];r.ma.isEmpty()||(r.ma.forEach((a,c)=>{o.push(r.va(c,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u?.fromCache?"not-current":"current"),u){i.push(u);let l=xa.Qi(c.targetId,u);s.push(l)}}))}),yield Promise.all(o),r.Va.a_(i),yield function(c,u){return d(this,null,function*(){let l=D(c);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>p.forEach(u,f=>p.forEach(f.ki,m=>l.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>p.forEach(f.qi,m=>l.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!er(h))throw h;y("LocalStore","Failed to update sequence numbers: "+h)}for(let h of u){let f=h.targetId;if(!h.fromCache){let m=l.ts.get(f),b=m.snapshotVersion,R=m.withLastLimboFreeSnapshotVersion(b);l.ts=l.ts.insert(f,R)}}})}(r.localStore,s))})}function Q_(t,e){return d(this,null,function*(){let n=D(t);if(!n.currentUser.isEqual(e)){y("SyncEngine","User change. New user:",e.toKey());let r=yield hd(n.localStore,e);n.currentUser=e,function(s,o){s.ba.forEach(a=>{a.forEach(c=>{c.reject(new I(_.CANCELLED,o))})}),s.ba.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ed(n,r._s)}})}function Y_(t,e){let n=D(t),r=n.ya.get(e);if(r&&r.Ra)return C().add(r.key);{let i=C(),s=n.fa.get(e);if(!s)return i;for(let o of s){let a=n.ma.get(o);i=i.unionWith(a.view.ua)}return i}}function J_(t){let e=D(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Id.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Y_.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=K_.bind(null,e),e.Va.a_=$_.bind(null,e.eventManager),e.Va.Fa=z_.bind(null,e.eventManager),e}var Oi=class{constructor(){this.synchronizeTabs=!1}initialize(e){return d(this,null,function*(){this.serializer=fd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return D_(this.persistence,new La,e.initialUser,this.serializer)}createPersistence(e){return new ka(Oa.jr,this.serializer)}createSharedClientState(e){return new Ua}terminate(){return d(this,null,function*(){this.gcScheduler&&this.gcScheduler.stop(),yield this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var rc=class{initialize(e,n){return d(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Vh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Q_.bind(null,this.syncEngine),yield U_(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Ya}()}createDatastore(e){let n=fd(e.databaseInfo.databaseId),r=function(s){return new $a(s)}(e.databaseInfo);return function(s,o,a,c){return new Ga(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new Ka(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Vh(this.syncEngine,n,0),function(){return Ri.D()?new Ri:new qa}())}createSyncEngine(e,n){return function(i,s,o,a,c,u,l){let h=new tc(i,s,o,a,c,u);return l&&(h.Ca=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return function(n){return d(this,null,function*(){let r=D(n);y("RemoteStore","RemoteStore shutting down."),r.C_.add(5),yield tr(r),r.F_.shutdown(),r.M_.set("Unknown")})}(this.remoteStore)}};var ic=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):ke("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var sc=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=H.UNAUTHENTICATED,this.clientId=Ko.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>d(this,null,function*(){y("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(y("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}getConfiguration(){return d(this,null,function*(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}})}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new I(_.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new qe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>d(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=yd(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Uo(t,e){return d(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),y("FirestoreClient","Initializing OfflineComponentProvider");let n=yield t.getConfiguration();yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>d(this,null,function*(){r.isEqual(i)||(yield hd(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function Mh(t,e){return d(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield Z_(t);y("FirestoreClient","Initializing OnlineComponentProvider");let r=yield t.getConfiguration();yield e.initialize(n,r),t.setCredentialChangeListener(i=>xh(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>xh(e.remoteStore,s)),t._onlineComponents=e})}function X_(t){return t.name==="FirebaseError"?t.code===_.FAILED_PRECONDITION||t.code===_.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function Z_(t){return d(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){y("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Uo(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!X_(n))throw n;Ft("Error using user provided cache. Falling back to memory cache: "+n),yield Uo(t,new Oi)}}else y("FirestoreClient","Using default OfflineComponentProvider"),yield Uo(t,new Oi);return t._offlineComponents})}function ey(t){return d(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(y("FirestoreClient","Using user provided OnlineComponentProvider"),yield Mh(t,t._uninitializedComponentsProvider._online)):(y("FirestoreClient","Using default OnlineComponentProvider"),yield Mh(t,new rc))),t._onlineComponents})}function Fh(t){return d(this,null,function*(){let e=yield ey(t),n=e.eventManager;return n.onListen=j_.bind(null,e.syncEngine),n.onUnlisten=W_.bind(null,e.syncEngine),n})}function wd(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var Uh=new Map;function ty(t,e,n){if(!n)throw new I(_.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function ny(t,e,n,r){if(e===!0&&r===!0)throw new I(_.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function qh(t){if(v.isDocumentKey(t))throw new I(_.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ry(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":T()}function fi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new I(_.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=ry(t);throw new I(_.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}var xi=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new I(_.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new I(_.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ny("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wd((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new I(_.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new I(_.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new I(_.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Xn=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new xi({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new I(_.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new I(_.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new xi(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new qo;switch(r.type){case"firstParty":return new jo(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new I(_.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=Uh.get(n);r&&(y("ComponentProvider","Removing Datastore"),Uh.delete(n),r.terminate())}(this),Promise.resolve()}};function Td(t,e,n,r={}){var i;let s=(t=fi(t,Xn))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Ft("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=H.MOCK_USER;else{a=du(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new I(_.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new H(u)}t._authCredentials=new Bo(new pi(a,c))}}var Vi=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},ft=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},Lt=class t extends Vi{constructor(e,n,r){super(e,n,Ic(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ft(this.firestore,null,new v(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function Ad(t,e,...n){if(t=Oe(t),ty("collection","path",e),t instanceof Xn){let r=B.fromString(e,...n);return qh(r),new Lt(t,null,r)}{if(!(t instanceof ft||t instanceof Lt))throw new I(_.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(B.fromString(e,...n));return qh(r),new Lt(t.firestore,null,r)}}var oc=class{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new Pi(this,"async_queue_retry"),this.iu=()=>{let n=Fo();n&&y("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};let e=Fo();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;let n=Fo();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});let n=new qe;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){return d(this,null,function*(){if(this.Ya.length!==0){try{yield this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!er(e))throw e;y("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko(()=>this._u())}})}ou(e){let n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{this.eu=r,this.tu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw ke("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);let i=Ha.createAndSchedule(this,e,n,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&T()}verifyOperationInProgress(){}uu(){return d(this,null,function*(){let e;do e=this.Ja,yield e;while(e!==this.Ja)})}cu(e){for(let n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.Xa)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){let n=this.Xa.indexOf(e);this.Xa.splice(n,1)}};function Bh(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var Zn=class extends Xn{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new oc}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||bd(this),this._firestoreClient.terminate()}};function Sd(t,e){let n=typeof t=="object"?t:sn(),r=typeof t=="string"?t:e||"(default)",i=bs(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=lu("firestore");s&&Td(i,...s)}return i}function iy(t){return t._firestoreClient||bd(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function bd(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,u,l){return new Yo(a,c,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,wd(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new sc(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var ac=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(oe.fromBase64String(e))}catch(n){throw new I(_.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(oe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Li=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new I(_.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ge(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var cc=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new I(_.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new I(_.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return k(this._lat,e._lat)||k(this._long,e._long)}};var sy=new RegExp("[~\\*/\\[\\]]");function oy(t,e,n){if(e.search(sy)>=0)throw $h(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Li(...e.split("."))._internalPath}catch{throw $h(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function $h(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new I(_.INVALID_ARGUMENT,a+t+c)}var Mi=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new uc(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(Rd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},uc=class extends Mi{data(){return super.data()}};function Rd(t,e){return typeof e=="string"?oy(t,e):e instanceof Li?e._internalPath:e._delegate._internalPath}function ay(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new I(_.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var lc=class{convertValue(e,n="none"){switch(dt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return M(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes($e(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw T()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return Bi(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new cc(M(e.latitude),M(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=mc(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp($n(e));default:return null}}convertTimestamp(e){let n=Be(e);return new de(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=B.fromString(e);j(ld(r));let i=new Ii(r.get(1),r.get(3)),s=new v(r.popFirst(5));return i.isEqual(n)||ke(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};var ut=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Fi=class extends Mi{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Mt(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(Rd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Mt=class extends Fi{data(e={}){return super.data(e)}},hc=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ut(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Mt(this._firestore,this._userDataWriter,r.key,r,new ut(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new I(_.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Mt(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ut(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Mt(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ut(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,l=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:cy(a.type),doc:c,oldIndex:u,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function cy(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return T()}}var Ui=class extends lc{constructor(e){super(),this.firestore=e}convertBytes(e){return new ac(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new ft(this.firestore,null,n)}};function Sc(t,...e){var n,r,i;t=Oe(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||Bh(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(Bh(e[o])){let h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,u,l;if(t instanceof ft)u=fi(t.firestore,Zn),l=Ic(t._key.path),c={next:h=>{e[o]&&e[o](uy(u,t,h))},error:e[o+1],complete:e[o+2]};else{let h=fi(t,Vi);u=fi(h.firestore,Zn),l=h._query;let f=new Ui(u);c={next:m=>{e[o]&&e[o](new hc(u,f,h,m))},error:e[o+1],complete:e[o+2]},ay(t._query)}return function(f,m,b,R){let w=new ic(R),V=new Ja(m,w,b);return f.asyncQueue.enqueueAndForget(()=>d(this,null,function*(){return q_(yield Fh(f),V)})),()=>{w.Na(),f.asyncQueue.enqueueAndForget(()=>d(this,null,function*(){return B_(yield Fh(f),V)}))}}(iy(u),l,a,c)}function uy(t,e,n){let r=n.docs.get(e._key),i=new Ui(t);return new Fi(t,i,e._key,r,new ut(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(i){Yt=i})(Et),Le(new le("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Zn(new $o(r.getProvider("auth-internal")),new Wo(r.getProvider("app-check-internal")),function(u,l){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new I(_.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ii(u.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),G(fh,"4.3.2",e),G(fh,"4.3.2","esm2017")})();var Gi=function(){return Gi=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Gi.apply(this,arguments)};var dy={includeMetadataChanges:!1};function Pd(t,e){return e===void 0&&(e=dy),new Zt(function(n){var r=Sc(t,e,{next:n.next.bind(n),error:n.error.bind(n),complete:n.complete.bind(n)});return{unsubscribe:r}})}function Cd(t,e){var n;e===void 0&&(e={});var r=t.data(e);return!t.exists()||typeof r!="object"||r===null||!e.idField?r:Gi(Gi({},r),(n={},n[e.idField]=t.id,n))}function Dd(t){return Pd(t,{includeMetadataChanges:!0}).pipe(Qi(function(e){return e.docs}))}function kd(t,e){return e===void 0&&(e={}),Dd(t).pipe(Qi(function(n){return n.map(function(r){return Cd(r,e)})}))}var rr=class{constructor(e){return e}},Nd="firestore",bc=class{constructor(){return an(Nd)}};var Rc=new gt("angularfire2.firestore-instances");function fy(t,e){let n=Cs(Nd,t,e);return n&&new rr(n)}function py(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new rr(r)}}var my={provide:bc,deps:[[new Ne,Rc]]},gy={provide:rr,useFactory:fy,deps:[[new Ne,Rc],Xe]},_y=(()=>{let e=class e{constructor(){G("angularfire",Tt.full,"fst")}};$(e,"\u0275fac",function(i){return new(i||e)}),$(e,"\u0275mod",_t({type:e})),$(e,"\u0275inj",mt({providers:[gy,my]}));let t=e;return t})();function Uw(t,...e){return{ngModule:_y,providers:[{provide:Rc,useFactory:py(t),multi:!0,deps:[It,ur,cn,un,[new Ne,Or],[new Ne,on],...e]}]}}var qw=Je(kd,!0);var Bw=Je(Ad,!0);var $w=Je(Sd,!0);export{yy as a,Iy as b,pr as c,tu as d,nu as e,vy as f,qd as g,Fy as h,Uy as i,bI as j,RI as k,rr as l,Uw as m,qw as n,Bw as o,$w as p};
